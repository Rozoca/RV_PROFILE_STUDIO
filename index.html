<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RV Profile Studio | Professional CV Analysis</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&family=Source+Sans+3:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #fafaf9;
            --bg-secondary: #ffffff;
            --bg-accent: #1c1917;
            --text-primary: #1c1917;
            --text-secondary: #57534e;
            --text-muted: #a8a29e;
            --accent-gold: #b8860b;
            --accent-gold-light: #d4a846;
            --accent-copper: #a0522d;
            --border: #e7e5e4;
            --border-dark: #d6d3d1;
            --success: #059669;
            --warning: #d97706;
            --danger: #dc2626;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.04);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.06);
            --shadow-lg: 0 8px 24px rgba(0,0,0,0.08);
        }

        [data-theme="dark"] {
            --bg-primary: #0c0a09;
            --bg-secondary: #1c1917;
            --bg-accent: #fafaf9;
            --text-primary: #fafaf9;
            --text-secondary: #a8a29e;
            --text-muted: #78716c;
            --border: #292524;
            --border-dark: #44403c;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.2);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.3);
            --shadow-lg: 0 8px 24px rgba(0,0,0,0.4);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }

        body {
            font-family: 'Source Sans 3', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.7;
            font-size: 16px;
            transition: background 0.3s, color 0.3s;
        }

        h1, h2, h3, .serif {
            font-family: 'Cormorant Garamond', Georgia, serif;
            font-weight: 500;
        }

        .header {
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border);
            background: var(--bg-secondary);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo { display: flex; align-items: center; gap: 16px; }

        .logo-mark {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--accent-gold) 0%, var(--accent-copper) 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.4rem;
            font-weight: 700;
            letter-spacing: -1px;
        }

        .logo-text h1 { font-size: 1.4rem; font-weight: 600; letter-spacing: -0.5px; }
        .logo-text span { font-size: 0.75rem; color: var(--text-muted); letter-spacing: 2px; text-transform: uppercase; }

        .header-controls { display: flex; align-items: center; gap: 16px; }

        .lang-selector {
            display: flex;
            background: var(--bg-primary);
            border-radius: 8px;
            padding: 4px;
            border: 1px solid var(--border);
        }

        .lang-btn {
            padding: 8px 14px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .lang-btn:hover { color: var(--text-primary); }
        .lang-btn.active {
            background: var(--bg-secondary);
            color: var(--accent-gold);
            box-shadow: var(--shadow-sm);
        }

        .theme-toggle {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            border: 1px solid var(--border);
            background: var(--bg-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            transition: all 0.2s;
        }

        .theme-toggle:hover { border-color: var(--accent-gold); }

        .main-container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 60px 40px;
        }

        .hero { text-align: center; margin-bottom: 60px; }
        .hero h2 { font-size: 2.8rem; font-weight: 500; margin-bottom: 16px; letter-spacing: -1px; }
        .hero p { color: var(--text-secondary); font-size: 1.15rem; max-width: 600px; margin: 0 auto; }

        .phase-tabs { display: flex; justify-content: center; gap: 8px; margin-bottom: 48px; }

        .phase-tab {
            padding: 16px 32px;
            border: 2px solid var(--border);
            background: var(--bg-secondary);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .phase-tab:hover { border-color: var(--border-dark); }
        .phase-tab.active {
            border-color: var(--accent-gold);
            background: linear-gradient(135deg, rgba(184,134,11,0.05) 0%, rgba(160,82,45,0.05) 100%);
        }

        .phase-number {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .phase-tab.active .phase-number { background: var(--accent-gold); color: white; }
        .phase-tab.completed .phase-number { background: var(--success); color: white; }

        .phase-info h3 { font-family: 'Source Sans 3', sans-serif; font-size: 0.95rem; font-weight: 600; text-align: left; }
        .phase-info span { font-size: 0.8rem; color: var(--text-muted); }

        .panel { display: none; animation: fadeUp 0.4s ease; }
        .panel.active { display: block; }

        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 32px;
            margin-bottom: 24px;
            box-shadow: var(--shadow-sm);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border);
        }

        .card-title { display: flex; align-items: center; gap: 12px; }

        .card-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: linear-gradient(135deg, rgba(184,134,11,0.1) 0%, rgba(160,82,45,0.1) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .card-title h3 { font-family: 'Source Sans 3', sans-serif; font-size: 1.1rem; font-weight: 600; }
        .card-title span { font-size: 0.85rem; color: var(--text-muted); display: block; }

        .sector-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; }

        .sector-option {
            padding: 20px 16px;
            border: 2px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            background: var(--bg-secondary);
        }

        .sector-option:hover { border-color: var(--border-dark); transform: translateY(-2px); }
        .sector-option.selected {
            border-color: var(--accent-gold);
            background: linear-gradient(135deg, rgba(184,134,11,0.05) 0%, rgba(160,82,45,0.05) 100%);
        }

        .sector-option .icon { font-size: 1.6rem; margin-bottom: 8px; display: block; }
        .sector-option .name { font-size: 0.85rem; font-weight: 500; color: var(--text-primary); }

        .level-pills { display: flex; gap: 12px; flex-wrap: wrap; }

        .level-pill {
            flex: 1;
            min-width: 120px;
            padding: 16px 20px;
            border: 2px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            background: var(--bg-secondary);
        }

        .level-pill:hover { border-color: var(--border-dark); }
        .level-pill.selected {
            border-color: var(--accent-gold);
            background: linear-gradient(135deg, rgba(184,134,11,0.05) 0%, rgba(160,82,45,0.05) 100%);
        }

        .level-pill .label { font-weight: 600; font-size: 0.9rem; display: block; margin-bottom: 4px; }
        .level-pill .years { font-size: 0.8rem; color: var(--text-muted); }

        .text-input-wrapper { position: relative; }

        textarea {
            width: 100%;
            min-height: 240px;
            padding: 20px;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-family: 'Source Sans 3', sans-serif;
            font-size: 0.95rem;
            line-height: 1.7;
            resize: vertical;
            transition: border-color 0.2s;
        }

        textarea:focus { outline: none; border-color: var(--accent-gold); }
        textarea::placeholder { color: var(--text-muted); }

        .char-count { position: absolute; bottom: 12px; right: 16px; font-size: 0.75rem; color: var(--text-muted); }

        .btn {
            padding: 14px 28px;
            border-radius: 10px;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            border: none;
            font-family: 'Source Sans 3', sans-serif;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-gold) 0%, var(--accent-copper) 100%);
            color: white;
        }

        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(184,134,11,0.3); }
        .btn-primary:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 2px solid var(--border);
        }

        .btn-secondary:hover { border-color: var(--accent-gold); }

        .btn-ghost { background: transparent; color: var(--accent-gold); padding: 10px 16px; }
        .btn-ghost:hover { background: rgba(184,134,11,0.1); }

        .action-bar { display: flex; justify-content: center; gap: 16px; margin-top: 32px; flex-wrap: wrap; }

        .api-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px 20px;
            background: var(--bg-primary);
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .toggle-switch {
            width: 48px;
            height: 26px;
            background: var(--border);
            border-radius: 13px;
            position: relative;
            cursor: pointer;
            transition: background 0.2s;
        }

        .toggle-switch.active { background: var(--accent-gold); }

        .toggle-switch::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            top: 3px;
            left: 3px;
            transition: transform 0.2s;
            box-shadow: var(--shadow-sm);
        }

        .toggle-switch.active::after { transform: translateX(22px); }

        .api-input { display: none; margin-top: 16px; }
        .api-input.visible { display: block; }

        .api-input input {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid var(--border);
            border-radius: 10px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 0.95rem;
            font-family: 'Source Sans 3', sans-serif;
        }

        .api-input input:focus { outline: none; border-color: var(--accent-gold); }

        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .loading-overlay.visible { display: flex; }

        .loading-card {
            background: var(--bg-secondary);
            padding: 48px 64px;
            border-radius: 20px;
            text-align: center;
            box-shadow: var(--shadow-lg);
        }

        .spinner {
            width: 48px;
            height: 48px;
            border: 3px solid var(--border);
            border-top-color: var(--accent-gold);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin { to { transform: rotate(360deg); } }

        .results-section { display: none; }
        .results-section.visible { display: block; }

        .score-hero {
            text-align: center;
            padding: 48px;
            background: linear-gradient(135deg, rgba(184,134,11,0.08) 0%, rgba(160,82,45,0.08) 100%);
            border-radius: 20px;
            margin-bottom: 32px;
        }

        .score-value {
            font-family: 'Cormorant Garamond', serif;
            font-size: 5rem;
            font-weight: 600;
            color: var(--accent-gold);
            line-height: 1;
        }

        .score-label { font-size: 1.1rem; color: var(--text-secondary); margin-top: 12px; }

        .score-meta { display: flex; justify-content: center; gap: 32px; margin-top: 24px; flex-wrap: wrap; }

        .meta-item { display: flex; align-items: center; gap: 8px; }

        .meta-dot { width: 10px; height: 10px; border-radius: 50%; }
        .meta-dot.success { background: var(--success); }
        .meta-dot.warning { background: var(--warning); }
        .meta-dot.danger { background: var(--danger); }

        .executive-summary {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(184,134,11,0.03) 100%);
            border: 2px solid var(--accent-gold);
            border-radius: 16px;
            padding: 32px;
            margin-bottom: 24px;
        }

        .summary-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .summary-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--accent-gold);
        }

        .summary-content { line-height: 1.9; color: var(--text-secondary); }
        .summary-content p { margin-bottom: 16px; }
        .summary-content strong { color: var(--text-primary); }

        .competency-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 32px; }
        .radar-container { height: 300px; display: flex; align-items: center; justify-content: center; }
        .competency-bars { display: grid; gap: 16px; }
        .comp-item { display: flex; align-items: center; gap: 16px; }
        .comp-name { width: 120px; font-size: 0.85rem; font-weight: 500; flex-shrink: 0; }
        .comp-bar { flex: 1; height: 8px; background: var(--border); border-radius: 4px; overflow: hidden; }
        .comp-fill { height: 100%; border-radius: 4px; transition: width 0.8s ease; }
        .comp-fill.excellent { background: var(--success); }
        .comp-fill.good { background: var(--accent-gold); }
        .comp-fill.moderate { background: var(--warning); }
        .comp-fill.low { background: var(--danger); }
        .comp-score { width: 40px; text-align: right; font-weight: 600; font-size: 0.9rem; }

        .swot-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }

        .swot-box { padding: 24px; border-radius: 12px; border: 1px solid var(--border); }
        .swot-box.strengths { border-left: 4px solid var(--success); }
        .swot-box.weaknesses { border-left: 4px solid var(--danger); }
        .swot-box.opportunities { border-left: 4px solid var(--accent-gold); }
        .swot-box.threats { border-left: 4px solid var(--warning); }

        .swot-title { font-size: 0.8rem; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 12px; }
        .swot-box.strengths .swot-title { color: var(--success); }
        .swot-box.weaknesses .swot-title { color: var(--danger); }
        .swot-box.opportunities .swot-title { color: var(--accent-gold); }
        .swot-box.threats .swot-title { color: var(--warning); }

        .swot-list { list-style: none; font-size: 0.9rem; line-height: 1.8; }
        .swot-list li { padding-left: 16px; position: relative; }
        .swot-list li::before { content: '‚Üí'; position: absolute; left: 0; color: var(--text-muted); }

        .keywords-section { margin-bottom: 20px; }
        .keywords-label { font-size: 0.85rem; font-weight: 600; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
        .keywords-container { display: flex; flex-wrap: wrap; gap: 8px; }

        .keyword-tag { padding: 6px 14px; border-radius: 20px; font-size: 0.8rem; font-weight: 500; }
        .keyword-tag.found { background: rgba(5,150,105,0.1); color: var(--success); border: 1px solid rgba(5,150,105,0.2); }
        .keyword-tag.missing { background: rgba(220,38,38,0.1); color: var(--danger); border: 1px solid rgba(220,38,38,0.2); }
        .keyword-tag.golden { background: linear-gradient(135deg, var(--accent-gold), var(--accent-copper)); color: white; }

        .recommendation-item {
            display: flex;
            gap: 16px;
            padding: 20px;
            border: 1px solid var(--border);
            border-radius: 12px;
            margin-bottom: 12px;
            transition: border-color 0.2s;
        }

        .recommendation-item:hover { border-color: var(--accent-gold); }

        .rec-priority { width: 8px; border-radius: 4px; flex-shrink: 0; }
        .rec-priority.critical { background: var(--danger); }
        .rec-priority.high { background: var(--warning); }
        .rec-priority.medium { background: var(--accent-gold); }

        .rec-content h4 { font-family: 'Source Sans 3', sans-serif; font-size: 0.95rem; font-weight: 600; margin-bottom: 4px; }
        .rec-content p { font-size: 0.85rem; color: var(--text-secondary); }

        .footer {
            text-align: center;
            padding: 40px;
            border-top: 1px solid var(--border);
            margin-top: 60px;
        }

        .footer-brand { display: flex; align-items: center; justify-content: center; gap: 12px; margin-bottom: 12px; }
        .footer-brand .logo-mark { width: 32px; height: 32px; font-size: 1rem; }
        .footer p { font-size: 0.85rem; color: var(--text-muted); }

        @media (max-width: 900px) {
            .sector-grid { grid-template-columns: repeat(2, 1fr); }
            .competency-grid { grid-template-columns: 1fr; }
            .swot-grid { grid-template-columns: 1fr; }
        }

        @media (max-width: 600px) {
            .header { padding: 16px 20px; }
            .main-container { padding: 32px 20px; }
            .hero h2 { font-size: 2rem; }
            .phase-tabs { flex-direction: column; }
            .sector-grid { grid-template-columns: 1fr; }
            .level-pills { flex-direction: column; }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="logo">
            <div class="logo-mark">RV</div>
            <div class="logo-text">
                <h1>Profile Studio</h1>
                <span data-i18n="tagline">Professional Analysis</span>
            </div>
        </div>
        <div class="header-controls">
            <div class="lang-selector">
                <button class="lang-btn active" onclick="setLanguage('es')">ES</button>
                <button class="lang-btn" onclick="setLanguage('en')">EN</button>
                <button class="lang-btn" onclick="setLanguage('pt')">PT</button>
            </div>
            <button class="theme-toggle" onclick="toggleTheme()">üåô</button>
        </div>
    </header>

    <main class="main-container">
        <section class="hero">
            <h2 data-i18n="hero_title">Analiza tu perfil profesional</h2>
            <p data-i18n="hero_subtitle">Evaluaci√≥n inteligente de competencias con an√°lisis DAFO y recomendaciones personalizadas</p>
        </section>

        <div class="phase-tabs">
            <div class="phase-tab active" id="tab1" onclick="goToPhase(1)">
                <div class="phase-number">1</div>
                <div class="phase-info">
                    <h3 data-i18n="phase1_title">An√°lisis del Perfil</h3>
                    <span data-i18n="phase1_desc">Evaluaci√≥n de competencias</span>
                </div>
            </div>
            <div class="phase-tab" id="tab2" onclick="goToPhase(2)">
                <div class="phase-number">2</div>
                <div class="phase-info">
                    <h3 data-i18n="phase2_title">Adecuaci√≥n al Puesto</h3>
                    <span data-i18n="phase2_desc">Opcional: comparar con oferta</span>
                </div>
            </div>
        </div>

        <!-- Phase 1 -->
        <div class="panel active" id="phase1">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon">‚öôÔ∏è</div>
                        <div>
                            <h3 data-i18n="config_title">Configuraci√≥n</h3>
                            <span data-i18n="config_desc">Define el contexto del an√°lisis</span>
                        </div>
                    </div>
                </div>

                <div style="margin-bottom: 28px;">
                    <label style="display: block; font-weight: 600; margin-bottom: 14px; font-size: 0.9rem;" data-i18n="sector_label">Sector / Industria</label>
                    <div class="sector-grid" id="sectorGrid">
                        <div class="sector-option" data-sector="finance" onclick="selectSector(this)">
                            <span class="icon">üè¶</span>
                            <span class="name" data-i18n="sector_finance">Banca / Finanzas</span>
                        </div>
                        <div class="sector-option" data-sector="tech" onclick="selectSector(this)">
                            <span class="icon">üíª</span>
                            <span class="name" data-i18n="sector_tech">Tecnolog√≠a / IT</span>
                        </div>
                        <div class="sector-option" data-sector="consulting" onclick="selectSector(this)">
                            <span class="icon">üìä</span>
                            <span class="name" data-i18n="sector_consulting">Consultor√≠a</span>
                        </div>
                        <div class="sector-option" data-sector="pmo" onclick="selectSector(this)">
                            <span class="icon">üìã</span>
                            <span class="name" data-i18n="sector_pmo">Project Management</span>
                        </div>
                        <div class="sector-option" data-sector="transformation" onclick="selectSector(this)">
                            <span class="icon">üîÑ</span>
                            <span class="name" data-i18n="sector_transformation">Transformaci√≥n</span>
                        </div>
                        <div class="sector-option" data-sector="supply" onclick="selectSector(this)">
                            <span class="icon">üì¶</span>
                            <span class="name" data-i18n="sector_supply">Supply Chain / Log√≠stica</span>
                        </div>
                        <div class="sector-option" data-sector="hr" onclick="selectSector(this)">
                            <span class="icon">üë•</span>
                            <span class="name" data-i18n="sector_hr">Recursos Humanos</span>
                        </div>
                        <div class="sector-option" data-sector="marketing" onclick="selectSector(this)">
                            <span class="icon">üì¢</span>
                            <span class="name" data-i18n="sector_marketing">Marketing</span>
                        </div>
                        <div class="sector-option" data-sector="legal" onclick="selectSector(this)">
                            <span class="icon">‚öñÔ∏è</span>
                            <span class="name" data-i18n="sector_legal">Legal</span>
                        </div>
                        <div class="sector-option" data-sector="health" onclick="selectSector(this)">
                            <span class="icon">üè•</span>
                            <span class="name" data-i18n="sector_health">Salud / Pharma</span>
                        </div>
                        <div class="sector-option" data-sector="general" onclick="selectSector(this)">
                            <span class="icon">üåê</span>
                            <span class="name" data-i18n="sector_general">Otro / General</span>
                        </div>
                    </div>
                </div>

                <div style="margin-bottom: 28px;">
                    <label style="display: block; font-weight: 600; margin-bottom: 14px; font-size: 0.9rem;" data-i18n="level_label">Nivel profesional</label>
                    <div class="level-pills" id="levelPills">
                        <div class="level-pill" data-level="junior" onclick="selectLevel(this)">
                            <span class="label">Entry / Junior</span>
                            <span class="years" data-i18n="years_0_3">0-3 a√±os</span>
                        </div>
                        <div class="level-pill" data-level="mid" onclick="selectLevel(this)">
                            <span class="label">Mid-Level</span>
                            <span class="years" data-i18n="years_3_7">3-7 a√±os</span>
                        </div>
                        <div class="level-pill" data-level="senior" onclick="selectLevel(this)">
                            <span class="label">Senior / Lead</span>
                            <span class="years" data-i18n="years_7_12">7-12 a√±os</span>
                        </div>
                        <div class="level-pill" data-level="director" onclick="selectLevel(this)">
                            <span class="label">Director / Exec</span>
                            <span class="years" data-i18n="years_12_plus">12+ a√±os</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon">üìÑ</div>
                        <div>
                            <h3 data-i18n="cv_title">Curr√≠culum Vitae</h3>
                            <span data-i18n="cv_desc">Pega el contenido de tu CV</span>
                        </div>
                    </div>
                    <button class="btn-ghost" onclick="loadExampleCV()" data-i18n="load_example">Cargar ejemplo</button>
                </div>
                <div class="text-input-wrapper">
                    <textarea id="cvInput" placeholder="Pega aqu√≠ el contenido de tu CV..." data-i18n-placeholder="cv_placeholder"></textarea>
                    <span class="char-count"><span id="cvCharCount">0</span> caracteres</span>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon">üß†</div>
                        <div>
                            <h3 data-i18n="analysis_mode">Modo de an√°lisis</h3>
                            <span data-i18n="analysis_mode_desc">Elige entre an√°lisis r√°pido o con IA</span>
                        </div>
                    </div>
                </div>
                <div class="api-toggle">
                    <div class="toggle-switch" id="aiToggle" onclick="toggleAI()"></div>
                    <div>
                        <span style="font-weight: 600;" data-i18n="ai_analysis">An√°lisis con Claude AI</span>
                        <span style="display: block; font-size: 0.85rem; color: var(--text-muted);" data-i18n="ai_analysis_desc">An√°lisis m√°s profundo y contextual (requiere API Key)</span>
                    </div>
                </div>
                <div class="api-input" id="apiInput">
                    <input type="password" id="apiKey" placeholder="sk-ant-api03-..." data-i18n-placeholder="api_placeholder">
                </div>
            </div>

            <div class="action-bar">
                <button class="btn btn-primary" id="analyzeBtn" onclick="analyzeProfile()" disabled>
                    <span data-i18n="analyze_btn">Analizar Perfil</span>
                    <span>‚Üí</span>
                </button>
            </div>
        </div>

        <!-- Phase 2 -->
        <div class="panel" id="phase2">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon">üìã</div>
                        <div>
                            <h3 data-i18n="job_title">Descripci√≥n del puesto</h3>
                            <span data-i18n="job_desc">Pega la oferta de trabajo para comparar</span>
                        </div>
                    </div>
                    <button class="btn-ghost" onclick="loadExampleJob()" data-i18n="load_example">Cargar ejemplo</button>
                </div>
                <div class="text-input-wrapper">
                    <textarea id="jobInput" placeholder="Pega aqu√≠ la descripci√≥n del puesto..." data-i18n-placeholder="job_placeholder"></textarea>
                    <span class="char-count"><span id="jobCharCount">0</span> caracteres</span>
                </div>
            </div>

            <div class="action-bar">
                <button class="btn btn-secondary" onclick="goToPhase(1)">
                    <span>‚Üê</span>
                    <span data-i18n="back_btn">Volver</span>
                </button>
                <button class="btn btn-primary" id="compareFitBtn" onclick="analyzeJobFit()" disabled>
                    <span data-i18n="compare_btn">Analizar Adecuaci√≥n</span>
                    <span>‚Üí</span>
                </button>
            </div>
        </div>

        <!-- Results -->
        <div class="results-section" id="resultsSection">
            <div class="score-hero">
                <div class="score-value" id="mainScore">‚Äî</div>
                <div class="score-label" id="scoreLabel" data-i18n="profile_score">Puntuaci√≥n del Perfil</div>
                <div class="score-meta" id="scoreMeta"></div>
            </div>

            <div class="executive-summary" id="executiveSummary">
                <div class="summary-header">
                    <div class="summary-title" data-i18n="executive_summary">üìã S√≠ntesis Ejecutiva</div>
                    <button class="btn btn-secondary" onclick="downloadReport()">
                        <span>üì•</span>
                        <span data-i18n="download_report">Descargar Informe</span>
                    </button>
                </div>
                <div class="summary-content" id="summaryContent"></div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon">üìä</div>
                        <div>
                            <h3 data-i18n="competencies_title">Competencias</h3>
                            <span data-i18n="competencies_desc">Evaluaci√≥n por √°reas</span>
                        </div>
                    </div>
                </div>
                <div class="competency-grid">
                    <div class="radar-container">
                        <canvas id="radarChart"></canvas>
                    </div>
                    <div class="competency-bars" id="competencyBars"></div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon">üéØ</div>
                        <div>
                            <h3 data-i18n="swot_title">An√°lisis DAFO</h3>
                            <span data-i18n="swot_desc">Fortalezas, debilidades, oportunidades y amenazas</span>
                        </div>
                    </div>
                </div>
                <div class="swot-grid">
                    <div class="swot-box strengths">
                        <div class="swot-title" data-i18n="strengths">Fortalezas</div>
                        <ul class="swot-list" id="strengths"></ul>
                    </div>
                    <div class="swot-box weaknesses">
                        <div class="swot-title" data-i18n="weaknesses">Debilidades</div>
                        <ul class="swot-list" id="weaknesses"></ul>
                    </div>
                    <div class="swot-box opportunities">
                        <div class="swot-title" data-i18n="opportunities">Oportunidades</div>
                        <ul class="swot-list" id="opportunities"></ul>
                    </div>
                    <div class="swot-box threats">
                        <div class="swot-title" data-i18n="threats">Amenazas</div>
                        <ul class="swot-list" id="threats"></ul>
                    </div>
                </div>
            </div>

            <div class="card" id="keywordsCard" style="display: none;">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon">üîë</div>
                        <div>
                            <h3 data-i18n="keywords_title">Palabras Clave</h3>
                            <span data-i18n="keywords_desc">Coincidencias con la oferta</span>
                        </div>
                    </div>
                </div>
                <div class="keywords-section">
                    <div class="keywords-label">‚≠ê <span data-i18n="golden_keywords">Keywords estrat√©gicas</span></div>
                    <div class="keywords-container" id="goldenKeywords"></div>
                </div>
                <div class="keywords-section">
                    <div class="keywords-label">‚úì <span data-i18n="found_keywords">Encontradas</span></div>
                    <div class="keywords-container" id="foundKeywords"></div>
                </div>
                <div class="keywords-section">
                    <div class="keywords-label">‚úó <span data-i18n="missing_keywords">Ausentes</span></div>
                    <div class="keywords-container" id="missingKeywords"></div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon">üí°</div>
                        <div>
                            <h3 data-i18n="recommendations_title">Recomendaciones</h3>
                            <span data-i18n="recommendations_desc">Plan de mejora personalizado</span>
                        </div>
                    </div>
                </div>
                <div id="recommendations"></div>
            </div>

            <div class="action-bar" id="continueToPhase2" style="display: none;">
                <button class="btn btn-primary" onclick="goToPhase(2)">
                    <span data-i18n="continue_phase2">Continuar con Adecuaci√≥n al Puesto</span>
                    <span>‚Üí</span>
                </button>
            </div>

            <div class="action-bar">
                <button class="btn btn-secondary" onclick="newAnalysis()">
                    <span data-i18n="new_analysis">Nuevo An√°lisis</span>
                </button>
            </div>
        </div>
    </main>

    <div class="loading-overlay" id="loading">
        <div class="loading-card">
            <div class="spinner"></div>
            <p data-i18n="analyzing">Analizando perfil...</p>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-brand">
            <div class="logo-mark">RV</div>
            <span style="font-weight: 500;">RV Profile Studio</span>
        </div>
        <p data-i18n="footer_text">Herramienta profesional de an√°lisis de perfiles ‚Ä¢ Versi√≥n 5.2</p>
    </footer>

    <script>
        // ==================== I18N ====================
        const translations = {
            es: {
                tagline: "An√°lisis Profesional",
                hero_title: "Analiza tu perfil profesional",
                hero_subtitle: "Evaluaci√≥n inteligente de competencias con an√°lisis DAFO y recomendaciones personalizadas",
                phase1_title: "An√°lisis del Perfil",
                phase1_desc: "Evaluaci√≥n de competencias",
                phase2_title: "Adecuaci√≥n al Puesto",
                phase2_desc: "Opcional: comparar con oferta",
                config_title: "Configuraci√≥n",
                config_desc: "Define el contexto del an√°lisis",
                sector_label: "Sector / Industria",
                sector_finance: "Banca / Finanzas",
                sector_tech: "Tecnolog√≠a / IT",
                sector_consulting: "Consultor√≠a",
                sector_pmo: "Project Management",
                sector_transformation: "Transformaci√≥n",
                sector_supply: "Supply Chain / Log√≠stica",
                sector_marketing: "Marketing",
                sector_hr: "Recursos Humanos",
                sector_legal: "Legal",
                sector_health: "Salud / Pharma",
                sector_general: "Otro / General",
                level_label: "Nivel profesional",
                years_0_3: "0-3 a√±os",
                years_3_7: "3-7 a√±os",
                years_7_12: "7-12 a√±os",
                years_12_plus: "12+ a√±os",
                cv_title: "Curr√≠culum Vitae",
                cv_desc: "Pega el contenido de tu CV",
                cv_placeholder: "Pega aqu√≠ el contenido de tu CV...",
                load_example: "Cargar ejemplo",
                analysis_mode: "Modo de an√°lisis",
                analysis_mode_desc: "Elige entre an√°lisis r√°pido o con IA",
                ai_analysis: "An√°lisis con Claude AI",
                ai_analysis_desc: "An√°lisis m√°s profundo y contextual (requiere API Key)",
                analyze_btn: "Analizar Perfil",
                job_title: "Descripci√≥n del puesto",
                job_desc: "Pega la oferta de trabajo para comparar",
                job_placeholder: "Pega aqu√≠ la descripci√≥n del puesto...",
                back_btn: "Volver",
                compare_btn: "Analizar Adecuaci√≥n",
                profile_score: "Puntuaci√≥n del Perfil",
                fit_score: "Adecuaci√≥n al Puesto",
                executive_summary: "üìã S√≠ntesis Ejecutiva",
                download_report: "Descargar Informe",
                competencies_title: "Competencias",
                competencies_desc: "Evaluaci√≥n por √°reas",
                swot_title: "An√°lisis DAFO",
                swot_desc: "Fortalezas, debilidades, oportunidades y amenazas",
                strengths: "Fortalezas",
                weaknesses: "Debilidades",
                opportunities: "Oportunidades",
                threats: "Amenazas",
                keywords_title: "Palabras Clave",
                keywords_desc: "Coincidencias con la oferta",
                golden_keywords: "Keywords estrat√©gicas",
                found_keywords: "Encontradas",
                missing_keywords: "Ausentes",
                recommendations_title: "Recomendaciones",
                recommendations_desc: "Plan de mejora personalizado",
                continue_phase2: "Continuar con Adecuaci√≥n al Puesto",
                new_analysis: "Nuevo An√°lisis",
                analyzing: "Analizando perfil...",
                footer_text: "Herramienta profesional de an√°lisis de perfiles ‚Ä¢ Versi√≥n 5.2"
            },
            en: {
                tagline: "Professional Analysis",
                hero_title: "Analyze your professional profile",
                hero_subtitle: "Intelligent competency assessment with SWOT analysis and personalized recommendations",
                phase1_title: "Profile Analysis",
                phase1_desc: "Competency evaluation",
                phase2_title: "Job Fit",
                phase2_desc: "Optional: compare with job offer",
                config_title: "Configuration",
                config_desc: "Define the analysis context",
                sector_label: "Sector / Industry",
                sector_finance: "Banking / Finance",
                sector_tech: "Technology / IT",
                sector_consulting: "Consulting",
                sector_pmo: "Project Management",
                sector_transformation: "Transformation",
                sector_supply: "Supply Chain / Logistics",
                sector_marketing: "Marketing",
                sector_hr: "Human Resources",
                sector_legal: "Legal",
                sector_health: "Healthcare / Pharma",
                sector_general: "Other / General",
                level_label: "Professional level",
                years_0_3: "0-3 years",
                years_3_7: "3-7 years",
                years_7_12: "7-12 years",
                years_12_plus: "12+ years",
                cv_title: "Curriculum Vitae",
                cv_desc: "Paste your CV content",
                cv_placeholder: "Paste your CV content here...",
                load_example: "Load example",
                analysis_mode: "Analysis mode",
                analysis_mode_desc: "Choose between quick analysis or AI-powered",
                ai_analysis: "Claude AI Analysis",
                ai_analysis_desc: "Deeper contextual analysis (requires API Key)",
                analyze_btn: "Analyze Profile",
                job_title: "Job Description",
                job_desc: "Paste the job offer to compare",
                job_placeholder: "Paste the job description here...",
                back_btn: "Back",
                compare_btn: "Analyze Fit",
                profile_score: "Profile Score",
                fit_score: "Job Fit Score",
                executive_summary: "üìã Executive Summary",
                download_report: "Download Report",
                competencies_title: "Competencies",
                competencies_desc: "Assessment by areas",
                swot_title: "SWOT Analysis",
                swot_desc: "Strengths, weaknesses, opportunities and threats",
                strengths: "Strengths",
                weaknesses: "Weaknesses",
                opportunities: "Opportunities",
                threats: "Threats",
                keywords_title: "Keywords",
                keywords_desc: "Matches with job offer",
                golden_keywords: "Strategic keywords",
                found_keywords: "Found",
                missing_keywords: "Missing",
                recommendations_title: "Recommendations",
                recommendations_desc: "Personalized improvement plan",
                continue_phase2: "Continue to Job Fit Analysis",
                new_analysis: "New Analysis",
                analyzing: "Analyzing profile...",
                footer_text: "Professional profile analysis tool ‚Ä¢ Version 5.2"
            },
            pt: {
                tagline: "An√°lise Profissional",
                hero_title: "Analise seu perfil profissional",
                hero_subtitle: "Avalia√ß√£o inteligente de compet√™ncias com an√°lise SWOT e recomenda√ß√µes personalizadas",
                phase1_title: "An√°lise do Perfil",
                phase1_desc: "Avalia√ß√£o de compet√™ncias",
                phase2_title: "Adequa√ß√£o ao Cargo",
                phase2_desc: "Opcional: comparar com vaga",
                config_title: "Configura√ß√£o",
                config_desc: "Defina o contexto da an√°lise",
                sector_label: "Setor / Ind√∫stria",
                sector_finance: "Banc√°rio / Finan√ßas",
                sector_tech: "Tecnologia / TI",
                sector_consulting: "Consultoria",
                sector_pmo: "Gest√£o de Projetos",
                sector_transformation: "Transforma√ß√£o",
                sector_supply: "Supply Chain / Log√≠stica",
                sector_marketing: "Marketing",
                sector_hr: "Recursos Humanos",
                sector_legal: "Jur√≠dico",
                sector_health: "Sa√∫de / Pharma",
                sector_general: "Outro / Geral",
                level_label: "N√≠vel profissional",
                years_0_3: "0-3 anos",
                years_3_7: "3-7 anos",
                years_7_12: "7-12 anos",
                years_12_plus: "12+ anos",
                cv_title: "Curr√≠culo",
                cv_desc: "Cole o conte√∫do do seu curr√≠culo",
                cv_placeholder: "Cole aqui o conte√∫do do seu curr√≠culo...",
                load_example: "Carregar exemplo",
                analysis_mode: "Modo de an√°lise",
                analysis_mode_desc: "Escolha entre an√°lise r√°pida ou com IA",
                ai_analysis: "An√°lise com Claude AI",
                ai_analysis_desc: "An√°lise mais profunda e contextual (requer API Key)",
                analyze_btn: "Analisar Perfil",
                job_title: "Descri√ß√£o da Vaga",
                job_desc: "Cole a oferta de emprego para comparar",
                job_placeholder: "Cole aqui a descri√ß√£o da vaga...",
                back_btn: "Voltar",
                compare_btn: "Analisar Adequa√ß√£o",
                profile_score: "Pontua√ß√£o do Perfil",
                fit_score: "Adequa√ß√£o √† Vaga",
                executive_summary: "üìã S√≠ntese Executiva",
                download_report: "Baixar Relat√≥rio",
                competencies_title: "Compet√™ncias",
                competencies_desc: "Avalia√ß√£o por √°reas",
                swot_title: "An√°lise SWOT",
                swot_desc: "For√ßas, fraquezas, oportunidades e amea√ßas",
                strengths: "For√ßas",
                weaknesses: "Fraquezas",
                opportunities: "Oportunidades",
                threats: "Amea√ßas",
                keywords_title: "Palavras-Chave",
                keywords_desc: "Correspond√™ncias com a vaga",
                golden_keywords: "Keywords estrat√©gicas",
                found_keywords: "Encontradas",
                missing_keywords: "Ausentes",
                recommendations_title: "Recomenda√ß√µes",
                recommendations_desc: "Plano de melhoria personalizado",
                continue_phase2: "Continuar para Adequa√ß√£o √† Vaga",
                new_analysis: "Nova An√°lise",
                analyzing: "Analisando perfil...",
                footer_text: "Ferramenta profissional de an√°lise de perfis ‚Ä¢ Vers√£o 5.2"
            }
        };

        let currentLang = 'es';
        let currentTheme = 'light';
        let selectedSector = null;
        let selectedLevel = null;
        let useAI = false;
        let radarChart = null;
        let currentPhase = 1;
        let lastAnalysisResult = null;
        let lastCVText = '';

        function setLanguage(lang) {
            currentLang = lang;
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.lang-btn[onclick="setLanguage('${lang}')"]`).classList.add('active');
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[lang][key]) el.textContent = translations[lang][key];
            });
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                if (translations[lang][key]) el.placeholder = translations[lang][key];
            });
        }

        function toggleTheme() {
            currentTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.body.setAttribute('data-theme', currentTheme === 'dark' ? 'dark' : '');
            document.querySelector('.theme-toggle').textContent = currentTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
        }

        function selectSector(el) {
            document.querySelectorAll('.sector-option').forEach(opt => opt.classList.remove('selected'));
            el.classList.add('selected');
            selectedSector = el.dataset.sector;
            checkReady();
        }

        function selectLevel(el) {
            document.querySelectorAll('.level-pill').forEach(opt => opt.classList.remove('selected'));
            el.classList.add('selected');
            selectedLevel = el.dataset.level;
            checkReady();
        }

        function toggleAI() {
            useAI = !useAI;
            document.getElementById('aiToggle').classList.toggle('active', useAI);
            document.getElementById('apiInput').classList.toggle('visible', useAI);
        }

        function checkReady() {
            const cvText = document.getElementById('cvInput').value.trim();
            const ready = selectedSector && selectedLevel && cvText.length > 50;
            document.getElementById('analyzeBtn').disabled = !ready;
            const jobText = document.getElementById('jobInput').value.trim();
            document.getElementById('compareFitBtn').disabled = !ready || jobText.length < 50;
        }

        function goToPhase(phase) {
            currentPhase = phase;
            document.querySelectorAll('.phase-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.panel').forEach(panel => panel.classList.remove('active'));
            document.getElementById(`tab${phase}`).classList.add('active');
            document.getElementById(`phase${phase}`).classList.add('active');
            document.getElementById('resultsSection').classList.remove('visible');
        }

        function newAnalysis() {
            document.getElementById('cvInput').value = '';
            document.getElementById('jobInput').value = '';
            document.getElementById('resultsSection').classList.remove('visible');
            lastAnalysisResult = null;
            lastCVText = '';
            goToPhase(1);
            document.querySelectorAll('.sector-option').forEach(opt => opt.classList.remove('selected'));
            document.querySelectorAll('.level-pill').forEach(opt => opt.classList.remove('selected'));
            selectedSector = null;
            selectedLevel = null;
            checkReady();
        }

        document.getElementById('cvInput').addEventListener('input', function() {
            document.getElementById('cvCharCount').textContent = this.value.length;
            checkReady();
        });

        document.getElementById('jobInput').addEventListener('input', function() {
            document.getElementById('jobCharCount').textContent = this.value.length;
            checkReady();
        });

        // ==================== EJEMPLOS FICTICIOS ====================
        function loadExampleCV() {
            const examples = {
                es: `MAR√çA ELENA TORRES GARC√çA
Project Manager Senior | Transformaci√≥n Digital
Barcelona, Espa√±a | maria.torres@email.com | +34 612 345 678

PERFIL PROFESIONAL
Gestora de proyectos con 12 a√±os de experiencia en el sector tecnol√≥gico y financiero. Especializada en transformaci√≥n digital, metodolog√≠as √°giles y gesti√≥n del cambio. Liderazgo de equipos multidisciplinares de hasta 15 personas en proyectos de implementaci√≥n de sistemas ERP y CRM.

EXPERIENCIA PROFESIONAL

BANCO MEDITERR√ÅNEO | Senior Project Manager | 2019 - Presente
‚Ä¢ Liderazgo del programa de digitalizaci√≥n de sucursales (presupuesto 2.5M‚Ç¨)
‚Ä¢ Implementaci√≥n de sistema de pagos SEPA con 98% de √©xito en migraci√≥n
‚Ä¢ Gesti√≥n de equipo de 12 personas entre t√©cnicos y analistas
‚Ä¢ Reducci√≥n del 35% en tiempo de procesamiento de operaciones

TECH SOLUTIONS S.L. | Project Manager | 2015 - 2019
‚Ä¢ Direcci√≥n de proyectos de desarrollo software para clientes del IBEX 35
‚Ä¢ Certificaci√≥n en metodolog√≠as Scrum y PMI
‚Ä¢ Gesti√≥n de cartera de proyectos con valor superior a 1M‚Ç¨ anual

FORMACI√ìN ACAD√âMICA
‚Ä¢ MBA Direcci√≥n de Empresas - ESADE Business School (2018)
‚Ä¢ Ingenier√≠a Inform√°tica - Universitat Polit√®cnica de Catalunya (2012)
‚Ä¢ PMP Certification - Project Management Institute (2016)

COMPETENCIAS T√âCNICAS
Gesti√≥n de proyectos, JIRA, Confluence, MS Project, SAP, Salesforce, SCRUM, Kanban

IDIOMAS
Espa√±ol (Nativo), Catal√°n (Nativo), Ingl√©s (B2), Franc√©s (A2)`,
                en: `MARIA ELENA TORRES GARCIA
Senior Project Manager | Digital Transformation
Barcelona, Spain | maria.torres@email.com | +34 612 345 678

PROFESSIONAL PROFILE
Project manager with 12 years of experience in the technology and financial sector. Specialized in digital transformation, agile methodologies and change management. Leadership of multidisciplinary teams of up to 15 people in ERP and CRM implementation projects.

PROFESSIONAL EXPERIENCE

MEDITERRANEAN BANK | Senior Project Manager | 2019 - Present
‚Ä¢ Leadership of branch digitalization program (‚Ç¨2.5M budget)
‚Ä¢ SEPA payment system implementation with 98% migration success
‚Ä¢ Management of 12-person team of technicians and analysts
‚Ä¢ 35% reduction in operations processing time

TECH SOLUTIONS S.L. | Project Manager | 2015 - 2019
‚Ä¢ Software development project management for IBEX 35 clients
‚Ä¢ Scrum and PMI methodologies certification
‚Ä¢ Project portfolio management worth over ‚Ç¨1M annually

EDUCATION
‚Ä¢ MBA Business Management - ESADE Business School (2018)
‚Ä¢ Computer Engineering - Universitat Polit√®cnica de Catalunya (2012)
‚Ä¢ PMP Certification - Project Management Institute (2016)

TECHNICAL SKILLS
Project Management, JIRA, Confluence, MS Project, SAP, Salesforce, SCRUM, Kanban

LANGUAGES
Spanish (Native), Catalan (Native), English (B2), French (A2)`,
                pt: `MARIA ELENA TORRES GARCIA
Gerente de Projetos S√™nior | Transforma√ß√£o Digital
Barcelona, Espanha | maria.torres@email.com | +34 612 345 678

PERFIL PROFISSIONAL
Gestora de projetos com 12 anos de experi√™ncia no setor de tecnologia e financeiro. Especializada em transforma√ß√£o digital, metodologias √°geis e gest√£o de mudan√ßas. Lideran√ßa de equipes multidisciplinares de at√© 15 pessoas em projetos de implementa√ß√£o de ERP e CRM.

EXPERI√äNCIA PROFISSIONAL

BANCO MEDITERR√ÇNEO | Gerente de Projetos S√™nior | 2019 - Presente
‚Ä¢ Lideran√ßa do programa de digitaliza√ß√£o de ag√™ncias (or√ßamento 2.5M‚Ç¨)
‚Ä¢ Implementa√ß√£o do sistema de pagamentos SEPA com 98% de sucesso na migra√ß√£o
‚Ä¢ Gest√£o de equipe de 12 pessoas entre t√©cnicos e analistas
‚Ä¢ Redu√ß√£o de 35% no tempo de processamento de opera√ß√µes

TECH SOLUTIONS S.L. | Gerente de Projetos | 2015 - 2019
‚Ä¢ Dire√ß√£o de projetos de desenvolvimento de software para clientes do IBEX 35
‚Ä¢ Certifica√ß√£o em metodologias Scrum e PMI
‚Ä¢ Gest√£o de portf√≥lio de projetos com valor superior a 1M‚Ç¨ anual

FORMA√á√ÉO ACAD√äMICA
‚Ä¢ MBA Gest√£o de Empresas - ESADE Business School (2018)
‚Ä¢ Engenharia da Computa√ß√£o - Universitat Polit√®cnica de Catalunya (2012)
‚Ä¢ Certifica√ß√£o PMP - Project Management Institute (2016)

COMPET√äNCIAS T√âCNICAS
Gest√£o de projetos, JIRA, Confluence, MS Project, SAP, Salesforce, SCRUM, Kanban

IDIOMAS
Espanhol (Nativo), Catal√£o (Nativo), Ingl√™s (B2), Franc√™s (A2)`
            };
            document.getElementById('cvInput').value = examples[currentLang];
            document.getElementById('cvCharCount').textContent = examples[currentLang].length;
            checkReady();
        }

        function loadExampleJob() {
            const examples = {
                es: `DIRECTOR DE PROYECTOS DE TRANSFORMACI√ìN DIGITAL
Entidad Financiera L√≠der | Madrid

DESCRIPCI√ìN DEL PUESTO
Buscamos un/a Director/a de Proyectos con experiencia demostrada en transformaci√≥n digital del sector bancario para liderar iniciativas estrat√©gicas de modernizaci√≥n tecnol√≥gica.

RESPONSABILIDADES
‚Ä¢ Liderar programas de transformaci√≥n digital con presupuestos superiores a 5M‚Ç¨
‚Ä¢ Dirigir equipos de m√°s de 20 profesionales entre t√©cnicos, analistas y consultores
‚Ä¢ Gestionar la implementaci√≥n de sistemas de pagos (SEPA Instant, ISO20022)
‚Ä¢ Definir roadmaps tecnol√≥gicos y asegurar cumplimiento de plazos y presupuestos
‚Ä¢ Reporting directo a Direcci√≥n General sobre avances y riesgos
‚Ä¢ Coordinar con proveedores tecnol√≥gicos y stakeholders internacionales

REQUISITOS IMPRESCINDIBLES
‚Ä¢ M√≠nimo 15 a√±os de experiencia en gesti√≥n de proyectos tecnol√≥gicos
‚Ä¢ Experiencia espec√≠fica en sector bancario/financiero (m√≠nimo 8 a√±os)
‚Ä¢ Certificaci√≥n PMP o PRINCE2 vigente
‚Ä¢ Ingl√©s nivel C1 certificado (se realizar√°n entrevistas en ingl√©s)
‚Ä¢ Experiencia en metodolog√≠as Agile a escala (SAFe, LeSS)
‚Ä¢ Conocimiento profundo de regulaci√≥n bancaria (PSD2, DORA)

REQUISITOS VALORABLES
‚Ä¢ MBA o formaci√≥n de postgrado en direcci√≥n de empresas
‚Ä¢ Experiencia internacional en entornos multiculturales
‚Ä¢ Conocimiento de sistemas SWIFT y mensajer√≠a financiera
‚Ä¢ Certificaci√≥n Lean Six Sigma

OFRECEMOS
‚Ä¢ Contrato indefinido
‚Ä¢ Salario: 90.000‚Ç¨ - 120.000‚Ç¨ seg√∫n experiencia
‚Ä¢ Bonus anual hasta 25% del salario
‚Ä¢ Teletrabajo h√≠brido (60% remoto)
‚Ä¢ Plan de pensiones y seguro m√©dico premium`,
                en: `DIGITAL TRANSFORMATION PROJECT DIRECTOR
Leading Financial Institution | Madrid

JOB DESCRIPTION
We are looking for a Project Director with proven experience in digital transformation in the banking sector to lead strategic technological modernization initiatives.

RESPONSIBILITIES
‚Ä¢ Lead digital transformation programs with budgets exceeding ‚Ç¨5M
‚Ä¢ Manage teams of more than 20 professionals including technicians, analysts and consultants
‚Ä¢ Manage the implementation of payment systems (SEPA Instant, ISO20022)
‚Ä¢ Define technology roadmaps and ensure compliance with deadlines and budgets
‚Ä¢ Direct reporting to General Management on progress and risks
‚Ä¢ Coordinate with technology vendors and international stakeholders

ESSENTIAL REQUIREMENTS
‚Ä¢ Minimum 15 years experience in technology project management
‚Ä¢ Specific experience in banking/financial sector (minimum 8 years)
‚Ä¢ Valid PMP or PRINCE2 certification
‚Ä¢ C1 certified English level (interviews will be conducted in English)
‚Ä¢ Experience in scaled Agile methodologies (SAFe, LeSS)
‚Ä¢ Deep knowledge of banking regulation (PSD2, DORA)

DESIRABLE REQUIREMENTS
‚Ä¢ MBA or postgraduate training in business management
‚Ä¢ International experience in multicultural environments
‚Ä¢ Knowledge of SWIFT systems and financial messaging
‚Ä¢ Lean Six Sigma certification

WE OFFER
‚Ä¢ Permanent contract
‚Ä¢ Salary: ‚Ç¨90,000 - ‚Ç¨120,000 depending on experience
‚Ä¢ Annual bonus up to 25% of salary
‚Ä¢ Hybrid remote work (60% remote)
‚Ä¢ Pension plan and premium health insurance`,
                pt: `DIRETOR DE PROJETOS DE TRANSFORMA√á√ÉO DIGITAL
Institui√ß√£o Financeira L√≠der | Madrid

DESCRI√á√ÉO DO CARGO
Procuramos um/a Diretor/a de Projetos com experi√™ncia comprovada em transforma√ß√£o digital no setor banc√°rio para liderar iniciativas estrat√©gicas de moderniza√ß√£o tecnol√≥gica.

RESPONSABILIDADES
‚Ä¢ Liderar programas de transforma√ß√£o digital com or√ßamentos superiores a 5M‚Ç¨
‚Ä¢ Dirigir equipes de mais de 20 profissionais entre t√©cnicos, analistas e consultores
‚Ä¢ Gerenciar a implementa√ß√£o de sistemas de pagamentos (SEPA Instant, ISO20022)
‚Ä¢ Definir roadmaps tecnol√≥gicos e garantir cumprimento de prazos e or√ßamentos
‚Ä¢ Reporte direto √† Dire√ß√£o Geral sobre avan√ßos e riscos
‚Ä¢ Coordenar com fornecedores de tecnologia e stakeholders internacionais

REQUISITOS ESSENCIAIS
‚Ä¢ M√≠nimo 15 anos de experi√™ncia em gest√£o de projetos tecnol√≥gicos
‚Ä¢ Experi√™ncia espec√≠fica no setor banc√°rio/financeiro (m√≠nimo 8 anos)
‚Ä¢ Certifica√ß√£o PMP ou PRINCE2 vigente
‚Ä¢ Ingl√™s n√≠vel C1 certificado (entrevistas ser√£o realizadas em ingl√™s)
‚Ä¢ Experi√™ncia em metodologias Agile em escala (SAFe, LeSS)
‚Ä¢ Conhecimento profundo de regula√ß√£o banc√°ria (PSD2, DORA)

REQUISITOS DESEJ√ÅVEIS
‚Ä¢ MBA ou forma√ß√£o de p√≥s-gradua√ß√£o em gest√£o de empresas
‚Ä¢ Experi√™ncia internacional em ambientes multiculturais
‚Ä¢ Conhecimento de sistemas SWIFT e mensageria financeira
‚Ä¢ Certifica√ß√£o Lean Six Sigma

OFERECEMOS
‚Ä¢ Contrato indefinido
‚Ä¢ Sal√°rio: 90.000‚Ç¨ - 120.000‚Ç¨ conforme experi√™ncia
‚Ä¢ B√¥nus anual at√© 25% do sal√°rio
‚Ä¢ Teletrabalho h√≠brido (60% remoto)
‚Ä¢ Plano de pens√£o e seguro m√©dico premium`
            };
            document.getElementById('jobInput').value = examples[currentLang];
            document.getElementById('jobCharCount').textContent = examples[currentLang].length;
            checkReady();
        }

        // ==================== MOTOR DE AN√ÅLISIS v5.2 - CALIBRADO ====================
        // Keywords por sector incluyendo los nuevos
        const sectorKeywords = {
            finance: ['swift', 'sepa', 'iso20022', 'pagos', 'payments', 'banking', 'banca', 'psd2', 'compliance', 'riesgo', 'treasury', 'tesorer√≠a', 'trading', 'fintech', 'aml', 'kyc', 'instant', 'dora'],
            tech: ['software', 'desarrollo', 'programming', 'agile', 'scrum', 'devops', 'cloud', 'aws', 'python', 'javascript', 'api', 'microservices', 'kubernetes', 'ci/cd', 'java', 'react'],
            consulting: ['estrategia', 'strategy', 'consulting', 'an√°lisis', 'analysis', 'due diligence', 'business case', 'stakeholder', 'transformation', 'cambio', 'change', 'roadmap'],
            pmo: ['pmo', 'project management', 'portfolio', 'programa', 'program', 'pmp', 'prince2', 'pmbok', 'ms project', 'jira', 'gantt', 'wbs', 'stakeholder', 'scope', 'risk', 'budget', 'milestone', 'sprint', 'backlog'],
            transformation: ['transformaci√≥n', 'transformation', 'change management', 'gesti√≥n del cambio', 'reingenier√≠a', 'digitalizaci√≥n', 'digitalization', 'bpm', 'lean', 'six sigma', 'kaizen', 'agile', 'roadmap', 'as-is', 'to-be', 'kpi', 'dashboard'],
            supply: ['supply chain', 'log√≠stica', 'logistics', 'procurement', 'compras', 'inventario', 'inventory', 'warehouse', 'almac√©n', 'transporte', 'transport', 'distribuci√≥n', 'distribution', 'erp', 'sap', 'mrp', 's&op', 'demand planning', 'forecasting', 'lean', 'just in time', 'jit'],
            marketing: ['branding', 'digital marketing', 'seo', 'sem', 'social media', 'content', 'analytics', 'campaign', 'roi', 'engagement', 'leads'],
            hr: ['talento', 'talent', 'recruiting', 'onboarding', 'desarrollo', 'performance', 'engagement', 'cultura', 'compensaci√≥n', 'formaci√≥n'],
            legal: ['compliance', 'regulaci√≥n', 'normativa', 'legal', 'contratos', 'rgpd', 'gdpr', 'audit', 'riesgo', 'governance'],
            health: ['pharma', 'clinical', 'regulatory', 'fda', 'ema', 'medical', 'healthcare', 'trials', 'gmp', 'patient'],
            general: ['gesti√≥n', 'management', 'proyecto', 'project', 'equipo', 'team', 'liderazgo', 'leadership', 'resultados', 'kpi']
        };

        const competencyLabels = {
            es: ['Experiencia', 'T√©cnico', 'Liderazgo', 'Soft Skills', 'Idiomas', 'Formaci√≥n'],
            en: ['Experience', 'Technical', 'Leadership', 'Soft Skills', 'Languages', 'Education'],
            pt: ['Experi√™ncia', 'T√©cnico', 'Lideran√ßa', 'Soft Skills', 'Idiomas', 'Forma√ß√£o']
        };

        function analyzeWithRules(cv, job = null) {
            const cvLower = cv.toLowerCase();
            const sector = selectedSector || 'general';
            const keywords = sectorKeywords[sector] || sectorKeywords.general;
            
            const foundKeywords = keywords.filter(kw => cvLower.includes(kw.toLowerCase()));
            const keywordScore = Math.min(100, (foundKeywords.length / keywords.length) * 140);
            
            // ============================================
            // EXPERIENCIA CALIBRADA v5.2
            // Los a√±os de experiencia son el factor PRINCIPAL
            // Las certificaciones son VALOR A√ëADIDO (+1 a +3 puntos)
            // ============================================
            const yearsMatch = cv.match(/(\d+)\+?\s*(a√±os|years|anos)/i);
            const years = yearsMatch ? parseInt(yearsMatch[1]) : 5;
            
            // Base de experiencia calculada SOLO por a√±os (representa ~97% del score)
            let experienceBase;
            if (years >= 20) experienceBase = 95;
            else if (years >= 15) experienceBase = 88;
            else if (years >= 12) experienceBase = 82;
            else if (years >= 10) experienceBase = 76;
            else if (years >= 8) experienceBase = 70;
            else if (years >= 6) experienceBase = 62;
            else if (years >= 4) experienceBase = 54;
            else if (years >= 2) experienceBase = 44;
            else experienceBase = 35;
            
            // Bonus por certificaciones de experiencia (+1 a +3 m√°ximo)
            let certBonus = 0;
            if (cvLower.includes('pmp') || cvLower.includes('prince2')) certBonus += 1;
            if (cvLower.includes('safe') || cvLower.includes('scrum master')) certBonus += 1;
            if (cvLower.includes('itil') || cvLower.includes('togaf')) certBonus += 1;
            certBonus = Math.min(certBonus, 3); // M√°ximo +3 puntos por certificaciones
            
            const experienceScore = Math.min(98, experienceBase + certBonus);
            
            // ============================================
            // FORMACI√ìN - Tambi√©n calibrada
            // T√≠tulos acad√©micos son lo principal
            // Certificaciones son complementarias
            // ============================================
            let educationBase = 35;
            if (cvLower.includes('mba') || cvLower.includes('m√°ster') || cvLower.includes('master')) educationBase += 25;
            if (cvLower.includes('licenciatura') || cvLower.includes('bachelor') || cvLower.includes('grado')) educationBase += 15;
            if (cvLower.includes('doctorado') || cvLower.includes('phd')) educationBase += 20;
            if (cvLower.match(/esade|iese|ie business|harvard|stanford|mit|insead/)) educationBase += 8;
            
            // Certificaciones t√©cnicas como bonus menor para formaci√≥n
            let eduCertBonus = 0;
            if (cvLower.includes('pmp') || cvLower.includes('prince2')) eduCertBonus += 2;
            if (cvLower.includes('lean') || cvLower.includes('six sigma')) eduCertBonus += 2;
            eduCertBonus = Math.min(eduCertBonus, 3);
            
            const educationScore = Math.min(95, educationBase + eduCertBonus);
            
            // Idiomas - detecci√≥n precisa
            const hasC1C2 = /\b(c1|c2|nativo|native|fluent|biling√ºe|bilingual)\b/i.test(cv);
            const hasB2 = /\bb2\b/i.test(cv);
            const hasB1 = /\bb1\b/i.test(cv);
            const langCount = (cv.match(/\b(ingl√©s|english|franc√©s|french|alem√°n|german|portugu√™s|portuguese|italiano|italian|chino|chinese)\b/gi) || []).length;
            
            let languageScore = 30;
            if (hasC1C2) languageScore += 40;
            else if (hasB2) languageScore += 25;
            else if (hasB1) languageScore += 15;
            languageScore += Math.min(30, langCount * 10);
            languageScore = Math.min(100, languageScore);
            
            // Liderazgo
            const leaderKeywords = ['l√≠der', 'leader', 'manager', 'director', 'coordinador', 'coordinator', 'equipo', 'team', 'gesti√≥n', 'management', 'personas', 'people'];
            const leaderFound = leaderKeywords.filter(k => cvLower.includes(k)).length;
            const leadershipScore = Math.min(100, 25 + leaderFound * 10);
            
            // Soft Skills
            const softKeywords = ['comunicaci√≥n', 'communication', 'negociaci√≥n', 'negotiation', 'colaboraci√≥n', 'collaboration', 'problem solving', 'anal√≠tico', 'analytical', 'stakeholder'];
            const softFound = softKeywords.filter(k => cvLower.includes(k)).length;
            const softScore = Math.min(100, 35 + softFound * 12);
            
            const scores = {
                experience: Math.round(experienceScore),
                technical: Math.round(keywordScore),
                leadership: Math.round(leadershipScore),
                soft: Math.round(softScore),
                languages: Math.round(languageScore),
                education: Math.round(educationScore)
            };
            
            const avgScore = Math.round(Object.values(scores).reduce((a,b) => a+b, 0) / 6);

            // DAFO - siempre genera debilidades realistas
            const swot = { strengths: [], weaknesses: [], opportunities: [], threats: [] };
            
            // Fortalezas
            if (scores.experience >= 70) swot.strengths.push(currentLang === 'en' ? 'Solid professional track record' : currentLang === 'pt' ? 'Trajet√≥ria profissional s√≥lida' : 'Trayectoria profesional consolidada');
            if (scores.technical >= 70) swot.strengths.push(currentLang === 'en' ? 'Strong technical expertise' : currentLang === 'pt' ? 'Forte expertise t√©cnica' : 'S√≥lida especializaci√≥n t√©cnica');
            if (scores.leadership >= 70) swot.strengths.push(currentLang === 'en' ? 'Proven team leadership' : currentLang === 'pt' ? 'Lideran√ßa de equipes comprovada' : 'Liderazgo de equipos demostrado');
            if (scores.education >= 75) swot.strengths.push(currentLang === 'en' ? 'Strong academic background' : currentLang === 'pt' ? 'Forte forma√ß√£o acad√™mica' : 'S√≥lida formaci√≥n acad√©mica');
            
            // DEBILIDADES - siempre al menos 2-3
            if (scores.languages < 80) {
                swot.weaknesses.push(currentLang === 'en' ? 'Language certifications could be strengthened (C1/C2 recommended)' : currentLang === 'pt' ? 'Certifica√ß√µes de idiomas podem ser fortalecidas (C1/C2 recomendado)' : 'Certificaciones de idiomas mejorables (C1/C2 recomendable)');
            }
            if (!cvLower.includes('pmp') && !cvLower.includes('prince2') && !cvLower.includes('safe')) {
                swot.weaknesses.push(currentLang === 'en' ? 'No project management certifications detected (PMP, PRINCE2, SAFe)' : currentLang === 'pt' ? 'Certifica√ß√µes de gest√£o de projetos n√£o detectadas (PMP, PRINCE2, SAFe)' : 'No se detectan certificaciones de gesti√≥n de proyectos (PMP, PRINCE2, SAFe)');
            }
            if (!cvLower.includes('lean') && !cvLower.includes('six sigma')) {
                swot.weaknesses.push(currentLang === 'en' ? 'No Lean/Six Sigma methodology mentioned' : currentLang === 'pt' ? 'Metodologia Lean/Six Sigma n√£o mencionada' : 'No se menciona metodolog√≠a Lean/Six Sigma');
            }
            if (scores.soft < 65) {
                swot.weaknesses.push(currentLang === 'en' ? 'Soft skills could be better highlighted' : currentLang === 'pt' ? 'Soft skills poderiam ser melhor destacadas' : 'Las soft skills podr√≠an destacarse m√°s');
            }
            if (!cvLower.includes('internacional') && !cvLower.includes('international') && !cvLower.includes('global')) {
                swot.weaknesses.push(currentLang === 'en' ? 'Limited international exposure visible' : currentLang === 'pt' ? 'Exposi√ß√£o internacional limitada vis√≠vel' : 'Exposici√≥n internacional limitada visible');
            }
            
            if (swot.weaknesses.length < 2) {
                swot.weaknesses.push(currentLang === 'en' ? 'CV could include more quantified achievements' : currentLang === 'pt' ? 'CV poderia incluir mais conquistas quantificadas' : 'El CV podr√≠a incluir m√°s logros cuantificados');
            }
            
            // Oportunidades
            swot.opportunities.push(currentLang === 'en' ? 'Digital transformation demand is growing' : currentLang === 'pt' ? 'Demanda por transforma√ß√£o digital em crescimento' : 'Demanda de transformaci√≥n digital en crecimiento');
            swot.opportunities.push(currentLang === 'en' ? 'New regulations create expert demand (DORA, PSD3)' : currentLang === 'pt' ? 'Novas regula√ß√µes criam demanda por especialistas (DORA, PSD3)' : 'Nuevas regulaciones crean demanda de expertos (DORA, PSD3)');
            if (scores.experience >= 60) swot.opportunities.push(currentLang === 'en' ? 'Profile suitable for leadership roles' : currentLang === 'pt' ? 'Perfil adequado para cargos de lideran√ßa' : 'Perfil apto para posiciones de direcci√≥n');
            
            // Amenazas
            swot.threats.push(currentLang === 'en' ? 'Increasing competition from specialized profiles' : currentLang === 'pt' ? 'Concorr√™ncia crescente de perfis especializados' : 'Competencia creciente de perfiles especializados');
            swot.threats.push(currentLang === 'en' ? 'Rapid technological changes require continuous learning' : currentLang === 'pt' ? 'Mudan√ßas tecnol√≥gicas r√°pidas exigem aprendizado cont√≠nuo' : 'Cambios tecnol√≥gicos r√°pidos exigen formaci√≥n continua');
            if (scores.technical < 70) swot.threats.push(currentLang === 'en' ? 'Risk of technical obsolescence' : currentLang === 'pt' ? 'Risco de obsolesc√™ncia t√©cnica' : 'Riesgo de obsolescencia t√©cnica');
            
            // Recomendaciones
            const recommendations = [];
            if (scores.languages < 80) {
                recommendations.push({
                    priority: 'high',
                    title: currentLang === 'en' ? 'Obtain C1 English certification' : currentLang === 'pt' ? 'Obter certifica√ß√£o C1 de ingl√™s' : 'Obtener certificaci√≥n C1 de ingl√©s',
                    description: currentLang === 'en' ? 'Many senior positions require certified C1 level. Consider Cambridge, IELTS or TOEFL' : currentLang === 'pt' ? 'Muitas posi√ß√µes seniores exigem n√≠vel C1 certificado. Considere Cambridge, IELTS ou TOEFL' : 'Muchas posiciones senior exigen nivel C1 certificado. Considera Cambridge, IELTS o TOEFL'
                });
            }
            if (!cvLower.includes('pmp') && !cvLower.includes('prince2')) {
                recommendations.push({
                    priority: 'medium',
                    title: currentLang === 'en' ? 'Consider PMP or PRINCE2 certification' : currentLang === 'pt' ? 'Considerar certifica√ß√£o PMP ou PRINCE2' : 'Considerar certificaci√≥n PMP o PRINCE2',
                    description: currentLang === 'en' ? 'Adds credibility for project management roles, though experience remains primary' : currentLang === 'pt' ? 'Adiciona credibilidade para cargos de gest√£o, embora a experi√™ncia seja prim√°ria' : 'Aporta credibilidad para roles de gesti√≥n, aunque la experiencia es lo primario'
                });
            }
            if (!cvLower.includes('lean') && !cvLower.includes('six sigma')) {
                recommendations.push({
                    priority: 'medium',
                    title: currentLang === 'en' ? 'Consider Lean Six Sigma certification' : currentLang === 'pt' ? 'Considerar certifica√ß√£o Lean Six Sigma' : 'Considerar certificaci√≥n Lean Six Sigma',
                    description: currentLang === 'en' ? 'Green Belt adds value for process optimization roles' : currentLang === 'pt' ? 'Green Belt agrega valor para cargos de otimiza√ß√£o' : 'Green Belt aporta valor para roles de optimizaci√≥n de procesos'
                });
            }
            recommendations.push({
                priority: 'medium',
                title: currentLang === 'en' ? 'Quantify all achievements' : currentLang === 'pt' ? 'Quantificar todas as conquistas' : 'Cuantificar todos los logros',
                description: currentLang === 'en' ? 'Add specific metrics: budgets managed, team sizes, % improvements achieved' : currentLang === 'pt' ? 'Adicionar m√©tricas espec√≠ficas: or√ßamentos, equipes, % de melhorias' : 'A√±adir m√©tricas espec√≠ficas: presupuestos gestionados, tama√±os de equipo, % de mejoras'
            });
            
            // Job Fit si hay oferta
            let jobFitData = null;
            let jobFitScore = avgScore;
            
            if (job) {
                const jobLower = job.toLowerCase();
                const jobRequirements = { yearsRequired: 0, certifications: [], languages: [], skills: [] };
                
                const jobYearsMatch = job.match(/(\d+)\+?\s*(a√±os|years|anos)\s*(de experiencia|experience|experi√™ncia)?/i);
                if (jobYearsMatch) jobRequirements.yearsRequired = parseInt(jobYearsMatch[1]);
                
                const certPatterns = ['pmp', 'prince2', 'safe', 'scrum master', 'itil', 'lean', 'six sigma', 'aws', 'azure'];
                certPatterns.forEach(cert => {
                    if (jobLower.includes(cert)) jobRequirements.certifications.push(cert);
                });
                
                const langPatterns = [
                    { pattern: /ingl√©s\s*(nivel\s*)?(c1|c2|nativo)/i, lang: 'english_c1' },
                    { pattern: /english\s*(level\s*)?(c1|c2|native)/i, lang: 'english_c1' },
                    { pattern: /ingl√©s\s*(nivel\s*)?(b2)/i, lang: 'english_b2' },
                    { pattern: /english\s*(level\s*)?(b2)/i, lang: 'english_b2' }
                ];
                langPatterns.forEach(lp => {
                    if (lp.pattern.test(job)) jobRequirements.languages.push(lp.lang);
                });
                
                let fitPoints = 0;
                let fitTotal = 0;
                
                // Experiencia (MAYOR PESO - 35%)
                if (jobRequirements.yearsRequired > 0) {
                    fitTotal += 35;
                    if (years >= jobRequirements.yearsRequired) fitPoints += 35;
                    else if (years >= jobRequirements.yearsRequired * 0.8) fitPoints += 25;
                    else if (years >= jobRequirements.yearsRequired * 0.6) fitPoints += 15;
                    else fitPoints += 5;
                }
                
                // Certificaciones (MENOR PESO - 15%)
                if (jobRequirements.certifications.length > 0) {
                    fitTotal += 15;
                    const matchedCerts = jobRequirements.certifications.filter(c => cvLower.includes(c)).length;
                    fitPoints += Math.round((matchedCerts / jobRequirements.certifications.length) * 15);
                }
                
                // Idiomas
                if (jobRequirements.languages.includes('english_c1')) {
                    fitTotal += 20;
                    if (hasC1C2) fitPoints += 20;
                    else if (hasB2) fitPoints += 10;
                    else fitPoints += 3;
                } else if (jobRequirements.languages.includes('english_b2')) {
                    fitTotal += 15;
                    if (hasC1C2 || hasB2) fitPoints += 15;
                    else if (hasB1) fitPoints += 8;
                }
                
                // Keywords del sector
                fitTotal += 30;
                const jobKeywords = [...new Set([...keywords, ...job.match(/\b[a-z√°√©√≠√≥√∫√±]{5,}\b/gi) || []])];
                const matchedKeywords = jobKeywords.filter(k => cvLower.includes(k.toLowerCase()));
                fitPoints += Math.round((matchedKeywords.length / Math.max(10, jobKeywords.length)) * 30);
                
                if (fitTotal > 0) {
                    jobFitScore = Math.round((fitPoints / fitTotal) * 100);
                }
                
                jobFitScore = Math.max(20, Math.min(95, jobFitScore));
                
                const importantJobKeywords = job.match(/\b[a-z√°√©√≠√≥√∫√±]{4,}\b/gi) || [];
                const uniqueJobKeywords = [...new Set(importantJobKeywords)].filter(k => k.length > 4);
                const foundInJob = uniqueJobKeywords.filter(k => cvLower.includes(k.toLowerCase()));
                const missingFromJob = uniqueJobKeywords.filter(k => !cvLower.includes(k.toLowerCase())).slice(0, 12);
                
                const firstLines = job.split('\n').slice(0, 3).join(' ').toLowerCase();
                const goldenWords = firstLines.match(/\b[a-z√°√©√≠√≥√∫√±]{5,}\b/gi) || [];
                
                jobFitData = {
                    found: foundInJob.slice(0, 15),
                    missing: missingFromJob,
                    golden: [...new Set(goldenWords)].slice(0, 6)
                };
            }
            
            const candidateName = cv.split('\n')[0].trim().split(/\s+/).slice(0, 3).join(' ');
            const synthesis = generateSynthesis(candidateName, scores, swot, job !== null);
            
            return {
                score: job ? jobFitScore : avgScore,
                competencies: scores,
                swot: swot,
                recommendations: recommendations,
                keywords: jobFitData,
                synthesis: synthesis,
                candidateName: candidateName,
                mode: 'rule'
            };
        }

        function generateSynthesis(name, scores, swot, isJobFit) {
            const avgScore = Math.round(Object.values(scores).reduce((a,b) => a+b, 0) / 6);
            const lang = currentLang;
            
            const templates = {
                es: {
                    intro: `<strong>${name}</strong> presenta un perfil profesional con una puntuaci√≥n global de <strong>${avgScore}%</strong>.`,
                    high: `Se trata de un profesional con una trayectoria consolidada que demuestra fortalezas significativas en m√∫ltiples √°reas. Su experiencia y competencias le posicionan favorablemente para roles de responsabilidad.`,
                    medium: `El perfil muestra una base s√≥lida con √°reas bien desarrolladas, aunque existen oportunidades claras de mejora que podr√≠an potenciar significativamente su competitividad en el mercado.`,
                    low: `El perfil presenta √°reas que requieren desarrollo para alcanzar mayor competitividad. Se recomienda un plan de acci√≥n enfocado en las debilidades identificadas.`,
                    strengths: `<strong>Puntos fuertes:</strong> ${swot.strengths.slice(0, 2).join(', ')}.`,
                    weaknesses: `<strong>√Åreas de mejora:</strong> ${swot.weaknesses.slice(0, 2).join('; ')}.`,
                    conclusion: isJobFit 
                        ? `En relaci√≥n con la posici√≥n analizada, se recomienda prestar especial atenci√≥n a los requisitos espec√≠ficos de la oferta y trabajar en las keywords ausentes identificadas.`
                        : `Para maximizar las oportunidades profesionales, se recomienda seguir el plan de acci√≥n propuesto, priorizando las competencias ling√º√≠sticas y la visibilidad del perfil.`
                },
                en: {
                    intro: `<strong>${name}</strong> presents a professional profile with an overall score of <strong>${avgScore}%</strong>.`,
                    high: `This is a professional with a consolidated track record demonstrating significant strengths in multiple areas. Their experience and competencies position them favorably for leadership roles.`,
                    medium: `The profile shows a solid foundation with well-developed areas, although there are clear improvement opportunities that could significantly enhance their market competitiveness.`,
                    low: `The profile presents areas requiring development to achieve greater competitiveness. An action plan focused on identified weaknesses is recommended.`,
                    strengths: `<strong>Key strengths:</strong> ${swot.strengths.slice(0, 2).join(', ')}.`,
                    weaknesses: `<strong>Areas for improvement:</strong> ${swot.weaknesses.slice(0, 2).join('; ')}.`,
                    conclusion: isJobFit
                        ? `Regarding the analyzed position, special attention to specific job requirements and working on identified missing keywords is recommended.`
                        : `To maximize professional opportunities, following the proposed action plan is recommended, prioritizing language competencies and profile visibility.`
                },
                pt: {
                    intro: `<strong>${name}</strong> apresenta um perfil profissional com uma pontua√ß√£o global de <strong>${avgScore}%</strong>.`,
                    high: `Trata-se de um profissional com uma trajet√≥ria consolidada que demonstra fortalezas significativas em m√∫ltiplas √°reas. Sua experi√™ncia e compet√™ncias o posicionam favoravelmente para cargos de responsabilidade.`,
                    medium: `O perfil mostra uma base s√≥lida com √°reas bem desenvolvidas, embora existam oportunidades claras de melhoria que poderiam potencializar significativamente sua competitividade no mercado.`,
                    low: `O perfil apresenta √°reas que requerem desenvolvimento para alcan√ßar maior competitividade. Recomenda-se um plano de a√ß√£o focado nas fraquezas identificadas.`,
                    strengths: `<strong>Pontos fortes:</strong> ${swot.strengths.slice(0, 2).join(', ')}.`,
                    weaknesses: `<strong>√Åreas de melhoria:</strong> ${swot.weaknesses.slice(0, 2).join('; ')}.`,
                    conclusion: isJobFit
                        ? `Em rela√ß√£o √† posi√ß√£o analisada, recomenda-se aten√ß√£o especial aos requisitos espec√≠ficos da vaga e trabalhar nas keywords ausentes identificadas.`
                        : `Para maximizar as oportunidades profissionais, recomenda-se seguir o plano de a√ß√£o proposto, priorizando as compet√™ncias lingu√≠sticas e visibilidade do perfil.`
                }
            };
            
            const t = templates[lang];
            const levelText = avgScore >= 75 ? t.high : avgScore >= 55 ? t.medium : t.low;
            
            return `<p>${t.intro}</p><p>${levelText}</p><p>${t.strengths}</p><p>${t.weaknesses}</p><p>${t.conclusion}</p>`;
        }

        async function analyzeProfile() {
            const cv = document.getElementById('cvInput').value.trim();
            lastCVText = cv;
            document.getElementById('loading').classList.add('visible');
            
            try {
                let result;
                if (useAI) {
                    const apiKey = document.getElementById('apiKey').value;
                    result = await analyzeWithAI(cv, null, apiKey);
                } else {
                    result = analyzeWithRules(cv);
                }
                lastAnalysisResult = result;
                displayResults(result, false);
            } catch (error) {
                console.error(error);
                alert('Error: ' + error.message);
                const result = analyzeWithRules(cv);
                lastAnalysisResult = result;
                displayResults(result, false);
            } finally {
                document.getElementById('loading').classList.remove('visible');
            }
        }

        async function analyzeJobFit() {
            const cv = document.getElementById('cvInput').value.trim() || lastCVText;
            const job = document.getElementById('jobInput').value.trim();
            document.getElementById('loading').classList.add('visible');
            
            try {
                let result;
                if (useAI) {
                    const apiKey = document.getElementById('apiKey').value;
                    result = await analyzeWithAI(cv, job, apiKey);
                } else {
                    result = analyzeWithRules(cv, job);
                }
                displayResults(result, true);
            } catch (error) {
                console.error(error);
                alert('Error: ' + error.message);
                displayResults(analyzeWithRules(cv, job), true);
            } finally {
                document.getElementById('loading').classList.remove('visible');
            }
        }

        async function analyzeWithAI(cv, job, apiKey) {
            if (!apiKey || !apiKey.startsWith('sk-ant-api')) {
                throw new Error('API Key inv√°lida');
            }
            
            const lang = currentLang === 'en' ? 'English' : currentLang === 'pt' ? 'Portuguese' : 'Spanish';
            const prompt = job ? 
                `Analyze this CV against the job offer. Respond in ${lang}. Be critical and identify real weaknesses. IMPORTANT: Years of experience is the PRIMARY factor (~95% weight), certifications add only 1-3% bonus.

CV:
${cv}

JOB:
${job}

Respond ONLY in valid JSON:
{"score":<0-100 realistic fit>,"competencies":{"experience":<0-100 based mainly on years>,"technical":<0-100>,"leadership":<0-100>,"soft":<0-100>,"languages":<0-100>,"education":<0-100>},"swot":{"strengths":[3 items],"weaknesses":[at least 3 real weaknesses],"opportunities":[2-3],"threats":[2-3]},"recommendations":[{"priority":"critical|high|medium","title":"...","description":"..."}],"keywords":{"golden":[5 key job terms],"found":[matched keywords],"missing":[important missing keywords]},"synthesis":"Executive summary paragraph"}` :
                `Analyze this professional profile. Respond in ${lang}. Be critical and identify real weaknesses. IMPORTANT: Years of experience is the PRIMARY factor (~95% weight), certifications add only 1-3% bonus.

CV:
${cv}

Sector: ${selectedSector}
Level: ${selectedLevel}

Respond ONLY in valid JSON:
{"score":<0-100>,"competencies":{"experience":<0-100 based mainly on years>,"technical":<0-100>,"leadership":<0-100>,"soft":<0-100>,"languages":<0-100>,"education":<0-100>},"swot":{"strengths":[3 items],"weaknesses":[at least 3 real weaknesses],"opportunities":[2-3],"threats":[2-3]},"recommendations":[{"priority":"critical|high|medium","title":"...","description":"..."}],"synthesis":"Executive summary paragraph"}`;

            const response = await fetch('https://api.anthropic.com/v1/messages', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'x-api-key': apiKey,
                    'anthropic-version': '2023-06-01',
                    'anthropic-dangerous-direct-browser-access': 'true'
                },
                body: JSON.stringify({
                    model: 'claude-sonnet-4-20250514',
                    max_tokens: 4000,
                    messages: [{ role: 'user', content: prompt }]
                })
            });

            if (!response.ok) throw new Error('API error: ' + response.status);
            const data = await response.json();
            const jsonMatch = data.content[0].text.match(/\{[\s\S]*\}/);
            if (!jsonMatch) throw new Error('Could not parse response');
            const result = JSON.parse(jsonMatch[0]);
            result.mode = 'ai';
            return result;
        }

        function displayResults(data, isJobFit) {
            document.getElementById('resultsSection').classList.add('visible');
            document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
            
            document.getElementById('mainScore').textContent = data.score + '%';
            document.getElementById('scoreLabel').textContent = translations[currentLang][isJobFit ? 'fit_score' : 'profile_score'];
            
            const scoreLevel = data.score >= 80 ? 'success' : data.score >= 60 ? 'warning' : 'danger';
            const scoreText = {
                success: { es: 'Excelente', en: 'Excellent', pt: 'Excelente' },
                warning: { es: 'Bueno', en: 'Good', pt: 'Bom' },
                danger: { es: 'A mejorar', en: 'Needs improvement', pt: 'A melhorar' }
            };
            
            document.getElementById('scoreMeta').innerHTML = `
                <div class="meta-item">
                    <span class="meta-dot ${scoreLevel}"></span>
                    <span>${scoreText[scoreLevel][currentLang]}</span>
                </div>
                <div class="meta-item">
                    <span style="color: var(--text-muted);">${data.mode === 'ai' ? 'üß† Claude AI' : '‚ö° Quick Analysis'}</span>
                </div>
            `;
            
            if (data.synthesis) {
                document.getElementById('summaryContent').innerHTML = typeof data.synthesis === 'string' 
                    ? `<p>${data.synthesis}</p>` 
                    : data.synthesis;
            } else {
                const name = data.candidateName || 'Candidato/a';
                document.getElementById('summaryContent').innerHTML = generateSynthesis(name, data.competencies, data.swot, isJobFit);
            }
            
            const labels = competencyLabels[currentLang];
            const compKeys = ['experience', 'technical', 'leadership', 'soft', 'languages', 'education'];
            
            document.getElementById('competencyBars').innerHTML = compKeys.map((key, i) => {
                const score = data.competencies[key];
                const level = score >= 80 ? 'excellent' : score >= 65 ? 'good' : score >= 50 ? 'moderate' : 'low';
                return `
                    <div class="comp-item">
                        <span class="comp-name">${labels[i]}</span>
                        <div class="comp-bar">
                            <div class="comp-fill ${level}" style="width: ${score}%"></div>
                        </div>
                        <span class="comp-score">${score}%</span>
                    </div>
                `;
            }).join('');
            
            updateRadar(data.competencies, labels);
            
            document.getElementById('strengths').innerHTML = data.swot.strengths.map(s => `<li>${s}</li>`).join('');
            document.getElementById('weaknesses').innerHTML = data.swot.weaknesses.map(s => `<li>${s}</li>`).join('');
            document.getElementById('opportunities').innerHTML = data.swot.opportunities.map(s => `<li>${s}</li>`).join('');
            document.getElementById('threats').innerHTML = data.swot.threats.map(s => `<li>${s}</li>`).join('');
            
            const keywordsCard = document.getElementById('keywordsCard');
            if (isJobFit && data.keywords) {
                keywordsCard.style.display = 'block';
                document.getElementById('goldenKeywords').innerHTML = data.keywords.golden.map(k => `<span class="keyword-tag golden">${k}</span>`).join('');
                document.getElementById('foundKeywords').innerHTML = data.keywords.found.map(k => `<span class="keyword-tag found">${k}</span>`).join('');
                document.getElementById('missingKeywords').innerHTML = data.keywords.missing.map(k => `<span class="keyword-tag missing">${k}</span>`).join('');
            } else {
                keywordsCard.style.display = 'none';
            }
            
            document.getElementById('recommendations').innerHTML = data.recommendations.map(r => `
                <div class="recommendation-item">
                    <div class="rec-priority ${r.priority}"></div>
                    <div class="rec-content">
                        <h4>${r.title}</h4>
                        <p>${r.description}</p>
                    </div>
                </div>
            `).join('');
            
            document.getElementById('continueToPhase2').style.display = isJobFit ? 'none' : 'flex';
        }

        function updateRadar(competencies, labels) {
            const ctx = document.getElementById('radarChart').getContext('2d');
            if (radarChart) radarChart.destroy();
            
            const compKeys = ['experience', 'technical', 'leadership', 'soft', 'languages', 'education'];
            
            radarChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Profile',
                        data: compKeys.map(k => competencies[k]),
                        fill: true,
                        backgroundColor: 'rgba(184, 134, 11, 0.15)',
                        borderColor: '#b8860b',
                        pointBackgroundColor: '#b8860b',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: 'rgba(0,0,0,0.1)' },
                            grid: { color: 'rgba(0,0,0,0.1)' },
                            pointLabels: { 
                                color: currentTheme === 'dark' ? '#a8a29e' : '#57534e',
                                font: { size: 11, family: 'Source Sans 3' }
                            },
                            ticks: { display: false },
                            suggestedMin: 0,
                            suggestedMax: 100
                        }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }

        function downloadReport() {
            if (!lastAnalysisResult) {
                alert('No hay an√°lisis para descargar');
                return;
            }
            
            const data = lastAnalysisResult;
            const date = new Date().toLocaleDateString(currentLang === 'en' ? 'en-US' : currentLang === 'pt' ? 'pt-BR' : 'es-ES');
            
            const reportContent = `
RV PROFILE STUDIO - INFORME PROFESIONAL
========================================
Fecha: ${date}
Generado por: RV Profile Studio v5.2

PUNTUACI√ìN GLOBAL: ${data.score}%

S√çNTESIS EJECUTIVA
------------------
${document.getElementById('summaryContent').innerText}

COMPETENCIAS
------------
- Experiencia: ${data.competencies.experience}%
- T√©cnico: ${data.competencies.technical}%
- Liderazgo: ${data.competencies.leadership}%
- Soft Skills: ${data.competencies.soft}%
- Idiomas: ${data.competencies.languages}%
- Formaci√≥n: ${data.competencies.education}%

AN√ÅLISIS DAFO
-------------
FORTALEZAS:
${data.swot.strengths.map(s => '‚Ä¢ ' + s).join('\n')}

DEBILIDADES:
${data.swot.weaknesses.map(s => '‚Ä¢ ' + s).join('\n')}

OPORTUNIDADES:
${data.swot.opportunities.map(s => '‚Ä¢ ' + s).join('\n')}

AMENAZAS:
${data.swot.threats.map(s => '‚Ä¢ ' + s).join('\n')}

RECOMENDACIONES
---------------
${data.recommendations.map(r => `[${r.priority.toUpperCase()}] ${r.title}\n   ${r.description}`).join('\n\n')}

========================================
RV Profile Studio | by RV
            `.trim();
            
            const blob = new Blob([reportContent], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `RV_Profile_Report_${date.replace(/\//g, '-')}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        checkReady();
    </script>
</body>
</html>
