<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RV Profile Studio | Career Intelligence & Professional Analysis</title>
    <meta name="description" content="AI-powered career consulting: CV analysis, SWOT reports, and job fit assessment in 3 languages.">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&family=DM+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        /* ============================================
           RV PROFILE STUDIO v2.1 - DESIGN SYSTEM
           Aesthetic: Refined Luxury Consulting
        ============================================ */
        
        :root {
            /* Colors - Warm Luxury Palette */
            --gold-50: #fefdfb;
            --gold-100: #fdf9f0;
            --gold-200: #f9f0db;
            --gold-300: #f0ddb3;
            --gold-400: #e4c378;
            --gold-500: #d4a853;
            --gold-600: #c4943f;
            --gold-700: #a37633;
            --gold-800: #865f2d;
            --gold-900: #6e4e27;
            
            --slate-50: #f8fafc;
            --slate-100: #f1f5f9;
            --slate-200: #e2e8f0;
            --slate-300: #cbd5e1;
            --slate-400: #94a3b8;
            --slate-500: #64748b;
            --slate-600: #475569;
            --slate-700: #334155;
            --slate-800: #1e293b;
            --slate-900: #0f172a;
            
            /* Semantic Colors */
            --bg-primary: var(--gold-50);
            --bg-card: #ffffff;
            --bg-elevated: #ffffff;
            --text-primary: var(--slate-900);
            --text-secondary: var(--slate-600);
            --text-muted: var(--slate-400);
            --brand: var(--gold-600);
            --brand-dark: var(--gold-700);
            --brand-light: var(--gold-200);
            --accent: var(--slate-800);
            
            --success: #059669;
            --success-bg: #ecfdf5;
            --warning: #d97706;
            --warning-bg: #fffbeb;
            --danger: #dc2626;
            --danger-bg: #fef2f2;
            --info: #0284c7;
            --info-bg: #f0f9ff;
            
            /* Typography */
            --font-display: 'Cormorant Garamond', Georgia, serif;
            --font-body: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            
            /* Spacing */
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
            --space-2xl: 48px;
            --space-3xl: 64px;
            
            /* Effects */
            --radius-sm: 6px;
            --radius-md: 12px;
            --radius-lg: 20px;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.04);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.06);
            --shadow-lg: 0 12px 40px rgba(0,0,0,0.08);
            --shadow-glow: 0 0 40px rgba(212, 168, 83, 0.15);
            
            --transition: 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        /* Dark Mode */
        [data-theme="dark"] {
            --bg-primary: #0c0c0c;
            --bg-card: #161616;
            --bg-elevated: #1a1a1a;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --brand-light: rgba(212, 168, 83, 0.15);
            --accent: #ffffff;
            --shadow-md: 0 4px 12px rgba(0,0,0,0.3);
            --shadow-lg: 0 12px 40px rgba(0,0,0,0.4);
            --success-bg: rgba(5, 150, 105, 0.15);
            --warning-bg: rgba(217, 119, 6, 0.15);
            --danger-bg: rgba(220, 38, 38, 0.15);
            --info-bg: rgba(2, 132, 199, 0.15);
        }
        
        /* ============================================
           BASE STYLES
        ============================================ */
        
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        body {
            font-family: var(--font-body);
            font-size: 16px;
            line-height: 1.7;
            color: var(--text-primary);
            background: var(--bg-primary);
            min-height: 100vh;
            transition: background var(--transition), color var(--transition);
        }
        
        h1, h2, h3, h4, h5, h6 {
            font-family: var(--font-display);
            font-weight: 600;
            line-height: 1.3;
            color: var(--text-primary);
        }
        
        a {
            color: var(--brand);
            text-decoration: none;
            transition: color var(--transition);
        }
        
        a:hover {
            color: var(--brand-dark);
        }
        
        ::selection {
            background: var(--brand);
            color: white;
        }
        
        /* ============================================
           LAYOUT
        ============================================ */
        
        .app-wrapper {
            max-width: 1100px;
            margin: 0 auto;
            padding: var(--space-lg);
        }
        
        @media (min-width: 768px) {
            .app-wrapper {
                padding: var(--space-2xl);
            }
        }
        
        /* ============================================
           HEADER
        ============================================ */
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-lg) 0;
            margin-bottom: var(--space-2xl);
            border-bottom: 1px solid var(--brand-light);
        }
        
        .logo {
            display: flex;
            align-items: baseline;
            gap: var(--space-xs);
        }
        
        .logo-mark {
            font-family: var(--font-display);
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--brand);
            letter-spacing: -1px;
        }
        
        .logo-text {
            font-family: var(--font-display);
            font-size: 1.4rem;
            font-weight: 400;
            color: var(--text-primary);
            letter-spacing: 1px;
        }
        
        .header-controls {
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }
        
        .lang-select {
            font-family: var(--font-body);
            font-size: 0.875rem;
            font-weight: 500;
            padding: var(--space-sm) var(--space-md);
            border: 1px solid var(--text-muted);
            border-radius: var(--radius-sm);
            background: transparent;
            color: var(--text-primary);
            cursor: pointer;
            transition: all var(--transition);
        }
        
        .lang-select:hover {
            border-color: var(--brand);
        }
        
        .theme-toggle {
            width: 40px;
            height: 40px;
            border: 1px solid var(--text-muted);
            border-radius: var(--radius-sm);
            background: transparent;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 1.1rem;
            transition: all var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .theme-toggle:hover {
            border-color: var(--brand);
            color: var(--brand);
        }
        
        /* ============================================
           STEPPER / NAVIGATION
        ============================================ */
        
        .stepper {
            display: flex;
            justify-content: center;
            gap: var(--space-xl);
            margin-bottom: var(--space-2xl);
            flex-wrap: wrap;
        }
        
        .step {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition);
            opacity: 0.5;
        }
        
        .step:hover {
            opacity: 0.8;
        }
        
        .step.active {
            opacity: 1;
            background: var(--brand-light);
        }
        
        .step.completed {
            opacity: 1;
        }
        
        .step-number {
            width: 32px;
            height: 32px;
            border: 2px solid currentColor;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.875rem;
            transition: all var(--transition);
        }
        
        .step.active .step-number {
            background: var(--brand);
            border-color: var(--brand);
            color: white;
        }
        
        .step.completed .step-number {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }
        
        .step-label {
            font-weight: 500;
            font-size: 0.95rem;
        }
        
        /* ============================================
           PANELS
        ============================================ */
        
        .panel {
            display: none;
            animation: panelFadeIn 0.4s ease;
        }
        
        .panel.active {
            display: block;
        }
        
        @keyframes panelFadeIn {
            from {
                opacity: 0;
                transform: translateY(12px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* ============================================
           CARDS
        ============================================ */
        
        .card {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin-bottom: var(--space-lg);
            box-shadow: var(--shadow-md);
            border: 1px solid rgba(0,0,0,0.04);
            transition: all var(--transition);
        }
        
        [data-theme="dark"] .card {
            border-color: rgba(255,255,255,0.05);
        }
        
        .card:hover {
            box-shadow: var(--shadow-lg);
        }
        
        .card-header {
            margin-bottom: var(--space-lg);
        }
        
        .card-title {
            font-size: 1.35rem;
            margin-bottom: var(--space-xs);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }
        
        .card-subtitle {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .card-icon {
            font-size: 1.2rem;
        }
        
        /* ============================================
           FORM ELEMENTS
        ============================================ */
        
        .form-group {
            margin-bottom: var(--space-lg);
        }
        
        .form-label {
            display: block;
            font-weight: 500;
            font-size: 0.9rem;
            margin-bottom: var(--space-sm);
            color: var(--text-primary);
        }
        
        .form-input,
        .form-textarea,
        .form-select {
            width: 100%;
            padding: var(--space-md);
            font-family: var(--font-body);
            font-size: 1rem;
            color: var(--text-primary);
            background: var(--bg-primary);
            border: 1px solid var(--slate-300);
            border-radius: var(--radius-md);
            transition: all var(--transition);
        }
        
        [data-theme="dark"] .form-input,
        [data-theme="dark"] .form-textarea,
        [data-theme="dark"] .form-select {
            border-color: var(--slate-700);
        }
        
        .form-input:focus,
        .form-textarea:focus,
        .form-select:focus {
            outline: none;
            border-color: var(--brand);
            box-shadow: 0 0 0 3px var(--brand-light);
        }
        
        .form-textarea {
            min-height: 220px;
            resize: vertical;
            line-height: 1.6;
        }
        
        .form-hint {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: var(--space-xs);
        }
        
        /* Option Pills / Selectors */
        .option-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: var(--space-sm);
        }
        
        .option-pill {
            padding: var(--space-md);
            border: 1px solid var(--slate-300);
            border-radius: var(--radius-md);
            text-align: center;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition);
            background: var(--bg-card);
        }
        
        [data-theme="dark"] .option-pill {
            border-color: var(--slate-700);
        }
        
        .option-pill:hover {
            border-color: var(--brand);
            color: var(--brand);
        }
        
        .option-pill.selected {
            background: var(--brand);
            border-color: var(--brand);
            color: white;
        }
        
        /* ============================================
           BUTTONS
        ============================================ */
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            padding: var(--space-md) var(--space-xl);
            font-family: var(--font-body);
            font-size: 1rem;
            font-weight: 600;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition);
            border: none;
            text-decoration: none;
        }
        
        .btn-primary {
            background: var(--brand);
            color: white;
            width: 100%;
        }
        
        .btn-primary:hover {
            background: var(--brand-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow);
        }
        
        .btn-primary:disabled {
            background: var(--text-muted);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .btn-secondary {
            background: transparent;
            border: 2px solid var(--brand);
            color: var(--brand);
        }
        
        .btn-secondary:hover {
            background: var(--brand-light);
        }
        
        .btn-ghost {
            background: transparent;
            color: var(--text-secondary);
            padding: var(--space-sm) var(--space-md);
        }
        
        .btn-ghost:hover {
            color: var(--brand);
            background: var(--brand-light);
        }
        
        .btn-group {
            display: flex;
            gap: var(--space-md);
            margin-top: var(--space-lg);
        }
        
        .btn-group .btn {
            flex: 1;
        }
        
        /* ============================================
           API TOGGLE SECTION
        ============================================ */
        
        .api-section {
            margin-top: var(--space-lg);
            padding-top: var(--space-lg);
            border-top: 1px solid var(--slate-200);
        }
        
        [data-theme="dark"] .api-section {
            border-color: var(--slate-700);
        }
        
        .api-toggle {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .api-toggle input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--brand);
        }
        
        .api-details {
            display: none;
            margin-top: var(--space-md);
            padding: var(--space-md);
            background: var(--bg-primary);
            border-radius: var(--radius-md);
        }
        
        .api-details.visible {
            display: block;
        }
        
        .api-info {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: var(--space-md);
            padding: var(--space-sm);
            background: var(--info-bg);
            border-radius: var(--radius-sm);
            border-left: 3px solid var(--info);
        }
        
        /* ============================================
           RESULTS SECTION - PDF CAPTURE READY
        ============================================ */
        
        #resultsContent {
            background: var(--bg-primary);
        }
        
        .results-header {
            text-align: center;
            padding: var(--space-2xl) var(--space-lg);
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-lg);
        }
        
        .results-brand {
            margin-bottom: var(--space-lg);
        }
        
        .results-brand .logo-mark {
            font-size: 1.8rem;
        }
        
        .results-brand .logo-text {
            font-size: 1.1rem;
        }
        
        .results-date {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-bottom: var(--space-md);
        }
        
        .score-circle {
            position: relative;
            width: 200px;
            height: 200px;
            margin: 0 auto var(--space-lg);
        }
        
        .score-canvas {
            position: absolute;
            top: 0;
            left: 0;
        }
        
        .score-value {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: var(--font-display);
            font-size: 3.5rem;
            font-weight: 700;
            color: var(--brand);
        }
        
        .score-label {
            font-size: 1.1rem;
            color: var(--text-secondary);
            margin-bottom: var(--space-md);
        }
        
        .score-interpretation {
            display: inline-block;
            padding: var(--space-sm) var(--space-lg);
            background: var(--brand-light);
            border-radius: var(--radius-lg);
            font-weight: 600;
            color: var(--brand-dark);
        }
        
        .profile-meta {
            display: flex;
            justify-content: center;
            gap: var(--space-xl);
            margin-top: var(--space-lg);
            padding-top: var(--space-lg);
            border-top: 1px solid var(--slate-200);
            flex-wrap: wrap;
        }
        
        .meta-item {
            text-align: center;
        }
        
        .meta-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-muted);
            margin-bottom: var(--space-xs);
        }
        
        .meta-value {
            font-weight: 600;
            color: var(--text-primary);
        }
        
        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            gap: var(--space-lg);
        }
        
        @media (min-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        /* Metric Bars */
        .metric-item {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            margin-bottom: var(--space-md);
        }
        
        .metric-label {
            width: 130px;
            font-size: 0.85rem;
            font-weight: 500;
            flex-shrink: 0;
        }
        
        .metric-bar {
            flex-grow: 1;
            height: 12px;
            background: var(--slate-200);
            border-radius: 6px;
            overflow: hidden;
        }
        
        [data-theme="dark"] .metric-bar {
            background: var(--slate-700);
        }
        
        .metric-fill {
            height: 100%;
            border-radius: 6px;
            transition: width 1s ease;
        }
        
        .metric-value {
            width: 50px;
            text-align: right;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        /* SWOT Grid */
        .swot-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-md);
        }
        
        @media (max-width: 600px) {
            .swot-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .swot-card {
            padding: var(--space-lg);
            border-radius: var(--radius-md);
        }
        
        .swot-strengths {
            background: var(--success-bg);
            border-left: 4px solid var(--success);
        }
        
        .swot-weaknesses {
            background: var(--danger-bg);
            border-left: 4px solid var(--danger);
        }
        
        .swot-opportunities {
            background: var(--info-bg);
            border-left: 4px solid var(--info);
        }
        
        .swot-threats {
            background: var(--warning-bg);
            border-left: 4px solid var(--warning);
        }
        
        .swot-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: var(--space-md);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }
        
        .swot-list {
            list-style: none;
        }
        
        .swot-list li {
            position: relative;
            padding-left: var(--space-lg);
            margin-bottom: var(--space-sm);
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        .swot-list li::before {
            content: '';
            position: absolute;
            left: 0;
            top: 8px;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: currentColor;
        }
        
        /* Recommendations */
        .rec-list {
            list-style: none;
        }
        
        .rec-item {
            display: flex;
            gap: var(--space-md);
            padding: var(--space-md);
            background: var(--bg-primary);
            border-radius: var(--radius-md);
            margin-bottom: var(--space-sm);
        }
        
        .rec-priority {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.8rem;
            flex-shrink: 0;
        }
        
        .rec-priority.high {
            background: var(--danger);
            color: white;
        }
        
        .rec-priority.medium {
            background: var(--warning);
            color: white;
        }
        
        .rec-priority.low {
            background: var(--success);
            color: white;
        }
        
        .rec-content {
            flex-grow: 1;
        }
        
        .rec-title {
            font-weight: 600;
            font-size: 0.95rem;
            margin-bottom: 2px;
        }
        
        .rec-desc {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        
        /* Keywords / Tags */
        .tag-list {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-sm);
        }
        
        .tag {
            padding: var(--space-xs) var(--space-md);
            background: var(--brand-light);
            color: var(--brand-dark);
            border-radius: var(--radius-lg);
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .tag.match {
            background: var(--success-bg);
            color: var(--success);
        }
        
        .tag.missing {
            background: var(--danger-bg);
            color: var(--danger);
        }
        
        /* Synthesis Text */
        .synthesis-text {
            font-size: 1rem;
            line-height: 1.8;
            color: var(--text-secondary);
        }
        
        /* CTA Card */
        .cta-card {
            background: linear-gradient(135deg, var(--brand) 0%, var(--brand-dark) 100%);
            color: white;
            text-align: center;
        }
        
        .cta-card .card-title {
            color: white;
            justify-content: center;
        }
        
        .cta-card p {
            opacity: 0.9;
            margin-bottom: var(--space-lg);
        }
        
        .cta-card .btn {
            background: white;
            color: var(--brand-dark);
        }
        
        .cta-card .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }
        
        /* Job Fit Section */
        .fit-comparison {
            display: grid;
            gap: var(--space-lg);
        }
        
        @media (min-width: 768px) {
            .fit-comparison {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        .fit-section-title {
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-muted);
            margin-bottom: var(--space-md);
        }
        
        /* Chart Container */
        .chart-container {
            position: relative;
            height: 300px;
            margin-bottom: var(--space-lg);
        }
        
        /* ============================================
           LOADING OVERLAY
        ============================================ */
        
        .loader-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.95);
            z-index: 9999;
            display: none;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
        
        [data-theme="dark"] .loader-overlay {
            background: rgba(0,0,0,0.95);
        }
        
        .loader-overlay.active {
            display: flex;
        }
        
        .spinner {
            width: 56px;
            height: 56px;
            border: 4px solid var(--brand-light);
            border-top-color: var(--brand);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .loader-text {
            margin-top: var(--space-lg);
            font-size: 1.1rem;
            color: var(--text-secondary);
        }
        
        /* ============================================
           UTILITY CLASSES
        ============================================ */
        
        .text-center { text-align: center; }
        .text-muted { color: var(--text-muted); }
        .text-success { color: var(--success); }
        .text-warning { color: var(--warning); }
        .text-danger { color: var(--danger); }
        .mt-lg { margin-top: var(--space-lg); }
        .mb-lg { margin-bottom: var(--space-lg); }
        .hidden { display: none !important; }
        
        /* ============================================
           PDF GENERATION STYLES
        ============================================ */
        
        .pdf-actions {
            display: flex;
            justify-content: center;
            gap: var(--space-md);
            margin-bottom: var(--space-xl);
            flex-wrap: wrap;
        }
        
        /* Footer for PDF */
        .results-footer {
            text-align: center;
            padding: var(--space-lg);
            margin-top: var(--space-lg);
            border-top: 1px solid var(--slate-200);
            font-size: 0.85rem;
            color: var(--text-muted);
        }
        
        .results-footer a {
            color: var(--brand);
        }
        
        /* ============================================
           PRINT / PDF STYLES
        ============================================ */
        
        @media print {
            body {
                background: white !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            .header-controls, .stepper, .pdf-actions, .cta-card, .api-section, #panel1, #panel2 {
                display: none !important;
            }
            .card {
                box-shadow: none !important;
                break-inside: avoid;
                page-break-inside: avoid;
            }
            .app-wrapper {
                max-width: 100%;
                padding: 10px;
            }
        }
        
        /* ============================================
           RESPONSIVE ADJUSTMENTS
        ============================================ */
        
        @media (max-width: 600px) {
            .header {
                flex-direction: column;
                gap: var(--space-md);
                text-align: center;
            }
            
            .stepper {
                gap: var(--space-sm);
            }
            
            .step-label {
                display: none;
            }
            
            .card {
                padding: var(--space-lg);
            }
            
            .score-value {
                font-size: 2.5rem;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .profile-meta {
                gap: var(--space-md);
            }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loader-overlay" id="loader">
        <div class="spinner"></div>
        <p class="loader-text" id="loaderText">Analizando perfil profesional...</p>
    </div>

    <div class="app-wrapper">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <span class="logo-mark">RV</span>
                <span class="logo-text">Profile Studio</span>
            </div>
            <div class="header-controls">
                <select class="lang-select" id="langSelect" onchange="changeLang(this.value)">
                    <option value="es">Espa√±ol</option>
                    <option value="en">English</option>
                    <option value="pt">Portugu√™s</option>
                </select>
                <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle theme">
                    <span id="themeIcon">üåô</span>
                </button>
            </div>
        </header>

        <!-- Stepper -->
        <nav class="stepper">
            <div class="step active" data-step="1" onclick="goToStep(1)">
                <div class="step-number">1</div>
                <span class="step-label" data-i18n="step_profile">Perfil</span>
            </div>
            <div class="step" data-step="2" onclick="goToStep(2)">
                <div class="step-number">2</div>
                <span class="step-label" data-i18n="step_jobfit">Job Fit</span>
            </div>
            <div class="step" data-step="3" onclick="goToStep(3)">
                <div class="step-number">3</div>
                <span class="step-label" data-i18n="step_results">Resultados</span>
            </div>
        </nav>

        <!-- Panel 1: Profile Analysis -->
        <section class="panel active" id="panel1">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <span class="card-icon">üéØ</span>
                        <span data-i18n="sector_title">Sector Profesional</span>
                    </h2>
                    <p class="card-subtitle" data-i18n="sector_subtitle">Selecciona tu √°rea de especializaci√≥n</p>
                </div>
                <div class="option-grid" id="sectorGrid"></div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <span class="card-icon">üìä</span>
                        <span data-i18n="level_title">Nivel de Experiencia</span>
                    </h2>
                </div>
                <div class="option-grid" id="levelGrid"></div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <span class="card-icon">üìÑ</span>
                        <span data-i18n="cv_title">Tu Curr√≠culum</span>
                    </h2>
                    <p class="card-subtitle" data-i18n="cv_subtitle">Copia y pega el contenido de tu CV</p>
                </div>
                <div class="form-group">
                    <textarea 
                        class="form-textarea" 
                        id="cvInput" 
                        placeholder="Pega aqu√≠ el texto de tu curr√≠culum..."
                        data-i18n-placeholder="cv_placeholder"
                    ></textarea>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: var(--space-sm);">
                        <button class="btn-ghost" onclick="loadExampleCV()" data-i18n="load_example">Cargar ejemplo</button>
                        <span class="form-hint" id="charCount">0 caracteres</span>
                    </div>
                </div>

                <div class="api-section">
                    <label class="api-toggle">
                        <input type="checkbox" id="aiToggle" onchange="toggleAI()">
                        <span data-i18n="ai_toggle">Habilitar an√°lisis profundo con IA (requiere API Key)</span>
                    </label>
                    <div class="api-details" id="apiDetails">
                        <p class="api-info" data-i18n="api_info">
                            ‚ÑπÔ∏è Usa tu propia API Key de Anthropic Claude para obtener un an√°lisis premium m√°s detallado y personalizado. Tus datos se env√≠an directamente a Anthropic de forma segura.
                        </p>
                        <input 
                            type="password" 
                            class="form-input" 
                            id="apiKeyInput" 
                            placeholder="sk-ant-api03-..."
                            autocomplete="off"
                        >
                    </div>
                </div>
            </div>

            <button class="btn btn-primary" onclick="runProfileAnalysis()" id="analyzeBtn">
                <span data-i18n="analyze_btn">Analizar Perfil</span>
                <span>‚Üí</span>
            </button>
        </section>

        <!-- Panel 2: Job Fit -->
        <section class="panel" id="panel2">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <span class="card-icon">üíº</span>
                        <span data-i18n="job_title">Descripci√≥n del Puesto</span>
                    </h2>
                    <p class="card-subtitle" data-i18n="job_subtitle">Pega la descripci√≥n de la oferta de trabajo para calcular tu compatibilidad</p>
                </div>
                <div class="form-group">
                    <textarea 
                        class="form-textarea" 
                        id="jobInput" 
                        placeholder="Copia aqu√≠ los requisitos y descripci√≥n del puesto..."
                        data-i18n-placeholder="job_placeholder"
                    ></textarea>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn btn-secondary" onclick="goToStep(1)">
                    <span>‚Üê</span>
                    <span data-i18n="back_btn">Atr√°s</span>
                </button>
                <button class="btn btn-primary" onclick="runJobFitAnalysis()">
                    <span data-i18n="calculate_fit_btn">Calcular Compatibilidad</span>
                    <span>‚Üí</span>
                </button>
            </div>
            
            <div style="text-align: center; margin-top: var(--space-lg);">
                <button class="btn-ghost" onclick="skipJobFit()" data-i18n="skip_jobfit">
                    Saltar este paso y ver solo an√°lisis de perfil
                </button>
            </div>
        </section>

        <!-- Panel 3: Results -->
        <section class="panel" id="panel3">
            
            <!-- PDF Actions (outside capture area) -->
            <div class="pdf-actions">
                <button class="btn btn-secondary" onclick="generatePDF()">
                    üì• <span data-i18n="download_pdf">Descargar Informe PDF</span>
                </button>
                <button class="btn btn-ghost" onclick="window.print()">
                    üñ®Ô∏è <span data-i18n="print_report">Imprimir</span>
                </button>
            </div>

            <!-- Results Content (will be captured for PDF) -->
            <div id="resultsContent">
                
                <!-- Header with Score -->
                <div class="results-header" id="resultsHeader">
                    <div class="results-brand">
                        <div class="logo" style="justify-content: center;">
                            <span class="logo-mark">RV</span>
                            <span class="logo-text">Profile Studio</span>
                        </div>
                    </div>
                    <p class="results-date" id="resultsDate"></p>
                    
                    <div class="score-circle">
                        <canvas id="scoreGauge" class="score-canvas" width="200" height="200"></canvas>
                        <div class="score-value" id="mainScore">0%</div>
                    </div>
                    <p class="score-label" id="scoreLabel">Puntuaci√≥n General del Perfil</p>
                    <span class="score-interpretation" id="scoreInterpretation">Calculando...</span>
                    
                    <div class="profile-meta">
                        <div class="meta-item">
                            <p class="meta-label" data-i18n="sector_title">Sector</p>
                            <p class="meta-value" id="metaSector">-</p>
                        </div>
                        <div class="meta-item">
                            <p class="meta-label" data-i18n="level_title">Nivel</p>
                            <p class="meta-value" id="metaLevel">-</p>
                        </div>
                        <div class="meta-item">
                            <p class="meta-label" data-i18n="meta_experience">Experiencia</p>
                            <p class="meta-value" id="metaYears">-</p>
                        </div>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div>
                        <!-- Competencies Chart -->
                        <div class="card" id="competenciesCard">
                            <h3 class="card-title" data-i18n="competencies_title">Competencias Profesionales</h3>
                            <div class="chart-container">
                                <canvas id="radarChart"></canvas>
                            </div>
                            <div id="metricsContainer"></div>
                        </div>

                        <!-- Executive Synthesis -->
                        <div class="card" id="synthesisCard">
                            <h3 class="card-title" data-i18n="synthesis_title">S√≠ntesis Ejecutiva</h3>
                            <p class="synthesis-text" id="synthesisText">Esperando an√°lisis...</p>
                        </div>
                    </div>

                    <div>
                        <!-- SWOT Analysis -->
                        <div class="card" id="swotCard">
                            <h3 class="card-title mb-lg" data-i18n="swot_title">An√°lisis DAFO</h3>
                            <div class="swot-grid" id="swotGrid">
                                <div class="swot-card swot-strengths">
                                    <div class="swot-title text-success">
                                        üí™ <span data-i18n="strengths">Fortalezas</span>
                                    </div>
                                    <ul class="swot-list" id="strengthsList"></ul>
                                </div>
                                <div class="swot-card swot-weaknesses">
                                    <div class="swot-title text-danger">
                                        ‚ö†Ô∏è <span data-i18n="weaknesses">Debilidades</span>
                                    </div>
                                    <ul class="swot-list" id="weaknessesList"></ul>
                                </div>
                                <div class="swot-card swot-opportunities">
                                    <div class="swot-title" style="color: var(--info);">
                                        üöÄ <span data-i18n="opportunities">Oportunidades</span>
                                    </div>
                                    <ul class="swot-list" id="opportunitiesList"></ul>
                                </div>
                                <div class="swot-card swot-threats">
                                    <div class="swot-title text-warning">
                                        üîç <span data-i18n="threats">Amenazas</span>
                                    </div>
                                    <ul class="swot-list" id="threatsList"></ul>
                                </div>
                            </div>
                        </div>

                        <!-- Recommendations -->
                        <div class="card" id="recommendationsCard">
                            <h3 class="card-title" data-i18n="recommendations_title">Plan de Acci√≥n</h3>
                            <ul class="rec-list" id="recommendationsList"></ul>
                        </div>
                    </div>
                </div>

                <!-- Job Fit Results (conditionally shown) -->
                <div class="card hidden" id="jobFitResults">
                    <h3 class="card-title mb-lg">üéØ <span data-i18n="jobfit_results_title">An√°lisis de Compatibilidad con el Puesto</span></h3>
                    
                    <div class="fit-comparison">
                        <div>
                            <p class="fit-section-title" data-i18n="matching_skills">Competencias Coincidentes</p>
                            <div class="tag-list" id="matchingSkills"></div>
                        </div>
                        <div>
                            <p class="fit-section-title" data-i18n="gap_skills">Brechas Identificadas</p>
                            <div class="tag-list" id="gapSkills"></div>
                        </div>
                    </div>
                    
                    <div class="mt-lg">
                        <h4 class="card-title" style="font-size: 1.1rem;" data-i18n="fit_recommendations">Recomendaciones para este Puesto</h4>
                        <p class="synthesis-text" id="fitRecommendationsText"></p>
                    </div>
                </div>

                <!-- Footer for PDF -->
                <div class="results-footer" id="resultsFooter">
                    <p>Generado con <strong>RV Profile Studio</strong> | <a href="mailto:rvprofilestudio@gmail.com">rvprofilestudio@gmail.com</a></p>
                    <p style="margin-top: 5px; font-size: 0.75rem;">Este informe es una evaluaci√≥n automatizada basada en el contenido proporcionado. Para un an√°lisis m√°s profundo, contacte con nuestro equipo de consultor√≠a.</p>
                </div>
            </div>

            <!-- CTA Card (outside PDF capture) -->
            <div class="card cta-card" style="margin-top: var(--space-lg);">
                <h3 class="card-title" data-i18n="cta_title">¬øNecesitas asesoramiento experto?</h3>
                <p data-i18n="cta_text">Solicita una sesi√≥n estrat√©gica de 1 hora para revisar estos resultados en profundidad.</p>
                <button class="btn" onclick="contactConsultant()">
                    üìß <span data-i18n="cta_btn">Contactar Consultor</span>
                </button>
            </div>

            <button class="btn btn-secondary" onclick="resetApp()" style="width: 100%; margin-top: var(--space-lg);">
                üîÑ <span data-i18n="new_analysis">Nuevo An√°lisis</span>
            </button>
        </section>
    </div>

    <script>
        // ============================================
        // RV PROFILE STUDIO v2.1 - APPLICATION LOGIC
        // ============================================

        // --- CONFIGURATION & STATE ---
        const CONFIG = {
            consultantEmail: 'rvprofilestudio@gmail.com',
            version: '2.1.0'
        };

        let state = {
            lang: 'es',
            sector: null,
            level: null,
            cv: '',
            job: '',
            apiKey: '',
            profileResults: null,
            jobFitResults: null,
            currentStep: 1,
            charts: {}
        };

        // --- INTERNATIONALIZATION (i18n) ---
        const translations = {
            es: {
                step_profile: 'Perfil',
                step_jobfit: 'Job Fit',
                step_results: 'Resultados',
                sector_title: 'Sector Profesional',
                sector_subtitle: 'Selecciona tu √°rea de especializaci√≥n',
                level_title: 'Nivel de Experiencia',
                cv_title: 'Tu Curr√≠culum',
                cv_subtitle: 'Copia y pega el contenido de tu CV',
                cv_placeholder: 'Pega aqu√≠ el texto de tu curr√≠culum...',
                load_example: 'Cargar ejemplo',
                ai_toggle: 'Habilitar an√°lisis profundo con IA (requiere API Key)',
                api_info: '‚ÑπÔ∏è Usa tu propia API Key de Anthropic Claude para obtener un an√°lisis premium m√°s detallado y personalizado.',
                analyze_btn: 'Analizar Perfil',
                job_title: 'Descripci√≥n del Puesto',
                job_subtitle: 'Pega la descripci√≥n de la oferta de trabajo para calcular tu compatibilidad',
                job_placeholder: 'Copia aqu√≠ los requisitos y descripci√≥n del puesto...',
                back_btn: 'Atr√°s',
                calculate_fit_btn: 'Calcular Compatibilidad',
                skip_jobfit: 'Saltar este paso y ver solo an√°lisis de perfil',
                download_pdf: 'Descargar Informe PDF',
                print_report: 'Imprimir',
                competencies_title: 'Competencias Profesionales',
                synthesis_title: 'S√≠ntesis Ejecutiva',
                swot_title: 'An√°lisis DAFO',
                strengths: 'Fortalezas',
                weaknesses: 'Debilidades',
                opportunities: 'Oportunidades',
                threats: 'Amenazas',
                recommendations_title: 'Plan de Acci√≥n',
                jobfit_results_title: 'An√°lisis de Compatibilidad con el Puesto',
                matching_skills: 'Competencias Coincidentes',
                gap_skills: 'Brechas Identificadas',
                fit_recommendations: 'Recomendaciones para este Puesto',
                cta_title: '¬øNecesitas asesoramiento experto?',
                cta_text: 'Solicita una sesi√≥n estrat√©gica de 1 hora para revisar estos resultados en profundidad.',
                cta_btn: 'Contactar Consultor',
                new_analysis: 'Nuevo An√°lisis',
                sector_tech: 'Tecnolog√≠a',
                sector_finance: 'Finanzas / Banca',
                sector_marketing: 'Marketing',
                sector_sales: 'Ventas / BizDev',
                sector_ops: 'Operaciones / PM',
                sector_hr: 'Recursos Humanos',
                sector_legal: 'Legal',
                sector_healthcare: 'Salud',
                level_junior: 'Junior (0-3 a√±os)',
                level_mid: 'Mid-Level (3-7 a√±os)',
                level_senior: 'Senior (7-15 a√±os)',
                level_exec: 'Executive (15+ a√±os)',
                loading_profile: 'Analizando perfil profesional...',
                loading_jobfit: 'Calculando compatibilidad...',
                loading_pdf: 'Generando informe PDF...',
                score_profile: 'Puntuaci√≥n General del Perfil',
                score_jobfit: 'Compatibilidad con el Puesto',
                interpretation_excellent: 'Perfil Excelente',
                interpretation_good: 'Perfil S√≥lido',
                interpretation_average: 'Perfil Competitivo',
                interpretation_developing: 'En Desarrollo',
                metric_experience: 'Experiencia',
                metric_education: 'Formaci√≥n',
                metric_skills: 'Habilidades T√©cnicas',
                metric_soft: 'Soft Skills',
                metric_achievements: 'Logros',
                metric_languages: 'Idiomas',
                meta_experience: 'Experiencia Detectada',
                years: 'a√±os',
                error_sector: 'Por favor, selecciona un sector profesional',
                error_level: 'Por favor, selecciona tu nivel de experiencia',
                error_cv: 'Por favor, introduce el contenido de tu CV (m√≠nimo 100 caracteres)',
                error_job: 'Por favor, introduce la descripci√≥n del puesto'
            },
            en: {
                step_profile: 'Profile',
                step_jobfit: 'Job Fit',
                step_results: 'Results',
                sector_title: 'Professional Sector',
                sector_subtitle: 'Select your area of expertise',
                level_title: 'Experience Level',
                cv_title: 'Your Resume',
                cv_subtitle: 'Copy and paste your CV content',
                cv_placeholder: 'Paste your resume text here...',
                load_example: 'Load example',
                ai_toggle: 'Enable deep AI analysis (requires API Key)',
                api_info: '‚ÑπÔ∏è Use your own Anthropic Claude API Key for a more detailed and personalized premium analysis.',
                analyze_btn: 'Analyze Profile',
                job_title: 'Job Description',
                job_subtitle: 'Paste the job description to calculate your compatibility',
                job_placeholder: 'Copy the job requirements and description here...',
                back_btn: 'Back',
                calculate_fit_btn: 'Calculate Fit',
                skip_jobfit: 'Skip this step and view profile analysis only',
                download_pdf: 'Download PDF Report',
                print_report: 'Print',
                competencies_title: 'Professional Competencies',
                synthesis_title: 'Executive Summary',
                swot_title: 'SWOT Analysis',
                strengths: 'Strengths',
                weaknesses: 'Weaknesses',
                opportunities: 'Opportunities',
                threats: 'Threats',
                recommendations_title: 'Action Plan',
                jobfit_results_title: 'Job Compatibility Analysis',
                matching_skills: 'Matching Skills',
                gap_skills: 'Identified Gaps',
                fit_recommendations: 'Recommendations for this Position',
                cta_title: 'Need expert advice?',
                cta_text: 'Request a 1-hour strategic session to review these results in depth.',
                cta_btn: 'Contact Consultant',
                new_analysis: 'New Analysis',
                sector_tech: 'Technology',
                sector_finance: 'Finance / Banking',
                sector_marketing: 'Marketing',
                sector_sales: 'Sales / BizDev',
                sector_ops: 'Operations / PM',
                sector_hr: 'Human Resources',
                sector_legal: 'Legal',
                sector_healthcare: 'Healthcare',
                level_junior: 'Junior (0-3 years)',
                level_mid: 'Mid-Level (3-7 years)',
                level_senior: 'Senior (7-15 years)',
                level_exec: 'Executive (15+ years)',
                loading_profile: 'Analyzing professional profile...',
                loading_jobfit: 'Calculating compatibility...',
                loading_pdf: 'Generating PDF report...',
                score_profile: 'Overall Profile Score',
                score_jobfit: 'Job Compatibility',
                interpretation_excellent: 'Excellent Profile',
                interpretation_good: 'Solid Profile',
                interpretation_average: 'Competitive Profile',
                interpretation_developing: 'Developing',
                metric_experience: 'Experience',
                metric_education: 'Education',
                metric_skills: 'Technical Skills',
                metric_soft: 'Soft Skills',
                metric_achievements: 'Achievements',
                metric_languages: 'Languages',
                meta_experience: 'Detected Experience',
                years: 'years',
                error_sector: 'Please select a professional sector',
                error_level: 'Please select your experience level',
                error_cv: 'Please enter your CV content (minimum 100 characters)',
                error_job: 'Please enter the job description'
            },
            pt: {
                step_profile: 'Perfil',
                step_jobfit: 'Job Fit',
                step_results: 'Resultados',
                sector_title: 'Setor Profissional',
                sector_subtitle: 'Selecione sua √°rea de especializa√ß√£o',
                level_title: 'N√≠vel de Experi√™ncia',
                cv_title: 'Seu Curr√≠culo',
                cv_subtitle: 'Copie e cole o conte√∫do do seu CV',
                cv_placeholder: 'Cole aqui o texto do seu curr√≠culo...',
                load_example: 'Carregar exemplo',
                ai_toggle: 'Habilitar an√°lise profunda com IA (requer API Key)',
                api_info: '‚ÑπÔ∏è Use sua pr√≥pria API Key do Anthropic Claude para uma an√°lise premium mais detalhada e personalizada.',
                analyze_btn: 'Analisar Perfil',
                job_title: 'Descri√ß√£o da Vaga',
                job_subtitle: 'Cole a descri√ß√£o da vaga para calcular sua compatibilidade',
                job_placeholder: 'Copie aqui os requisitos e descri√ß√£o da vaga...',
                back_btn: 'Voltar',
                calculate_fit_btn: 'Calcular Compatibilidade',
                skip_jobfit: 'Pular esta etapa e ver apenas an√°lise do perfil',
                download_pdf: 'Baixar Relat√≥rio PDF',
                print_report: 'Imprimir',
                competencies_title: 'Compet√™ncias Profissionais',
                synthesis_title: 'S√≠ntese Executiva',
                swot_title: 'An√°lise SWOT',
                strengths: 'For√ßas',
                weaknesses: 'Fraquezas',
                opportunities: 'Oportunidades',
                threats: 'Amea√ßas',
                recommendations_title: 'Plano de A√ß√£o',
                jobfit_results_title: 'An√°lise de Compatibilidade com a Vaga',
                matching_skills: 'Compet√™ncias Correspondentes',
                gap_skills: 'Lacunas Identificadas',
                fit_recommendations: 'Recomenda√ß√µes para esta Posi√ß√£o',
                cta_title: 'Precisa de assessoria especializada?',
                cta_text: 'Solicite uma sess√£o estrat√©gica de 1 hora para revisar estes resultados em profundidade.',
                cta_btn: 'Contatar Consultor',
                new_analysis: 'Nova An√°lise',
                sector_tech: 'Tecnologia',
                sector_finance: 'Finan√ßas / Banco',
                sector_marketing: 'Marketing',
                sector_sales: 'Vendas / BizDev',
                sector_ops: 'Opera√ß√µes / PM',
                sector_hr: 'Recursos Humanos',
                sector_legal: 'Jur√≠dico',
                sector_healthcare: 'Sa√∫de',
                level_junior: 'J√∫nior (0-3 anos)',
                level_mid: 'Pleno (3-7 anos)',
                level_senior: 'S√™nior (7-15 anos)',
                level_exec: 'Executivo (15+ anos)',
                loading_profile: 'Analisando perfil profissional...',
                loading_jobfit: 'Calculando compatibilidade...',
                loading_pdf: 'Gerando relat√≥rio PDF...',
                score_profile: 'Pontua√ß√£o Geral do Perfil',
                score_jobfit: 'Compatibilidade com a Vaga',
                interpretation_excellent: 'Perfil Excelente',
                interpretation_good: 'Perfil S√≥lido',
                interpretation_average: 'Perfil Competitivo',
                interpretation_developing: 'Em Desenvolvimento',
                metric_experience: 'Experi√™ncia',
                metric_education: 'Forma√ß√£o',
                metric_skills: 'Habilidades T√©cnicas',
                metric_soft: 'Soft Skills',
                metric_achievements: 'Conquistas',
                metric_languages: 'Idiomas',
                meta_experience: 'Experi√™ncia Detectada',
                years: 'anos',
                error_sector: 'Por favor, selecione um setor profissional',
                error_level: 'Por favor, selecione seu n√≠vel de experi√™ncia',
                error_cv: 'Por favor, insira o conte√∫do do seu CV (m√≠nimo 100 caracteres)',
                error_job: 'Por favor, insira a descri√ß√£o da vaga'
            }
        };

        // --- SECTOR & SKILL DEFINITIONS ---
        const sectors = {
            tech: {
                labelKey: 'sector_tech',
                keywords: {
                    technical: ['javascript', 'python', 'java', 'react', 'angular', 'vue', 'node', 'aws', 'azure', 'gcp', 'docker', 'kubernetes', 'sql', 'nosql', 'mongodb', 'postgresql', 'git', 'ci/cd', 'devops', 'api', 'rest', 'graphql', 'microservices', 'testing', 'cloud', 'security', 'machine learning', 'data science', 'tensorflow', 'pytorch', 'agile', 'scrum', 'typescript', 'golang', 'rust', 'linux', 'networking'],
                    soft: ['problem solving', 'teamwork', 'communication', 'innovation', 'leadership', 'adaptability', 'analytical', 'creativity', 'collaboration'],
                    achievements: ['delivered', 'implemented', 'optimized', 'reduced', 'increased', 'developed', 'architected', 'scaled', 'automated', 'migrated']
                }
            },
            finance: {
                labelKey: 'sector_finance',
                keywords: {
                    technical: ['financial analysis', 'forecasting', 'budgeting', 'audit', 'compliance', 'risk management', 'ifrs', 'gaap', 'sap', 'excel', 'bloomberg', 'trading', 'aml', 'kyc', 'reporting', 'tax', 'treasury', 'valuation', 'm&a', 'portfolio', 'derivatives', 'fixed income', 'equity', 'credit', 'swift', 'sepa', 'payments', 'banking', 'iso20022', 'psd2', 'regulatory', 'basel'],
                    soft: ['attention to detail', 'analytical', 'integrity', 'communication', 'stakeholder management', 'strategic thinking', 'decision making'],
                    achievements: ['managed', 'audited', 'reduced costs', 'increased revenue', 'implemented', 'optimized', 'compliance', 'savings']
                }
            },
            marketing: {
                labelKey: 'sector_marketing',
                keywords: {
                    technical: ['seo', 'sem', 'google analytics', 'google ads', 'facebook ads', 'social media', 'crm', 'hubspot', 'salesforce', 'content marketing', 'branding', 'kpi', 'roi', 'leads', 'funnel', 'email marketing', 'growth hacking', 'copywriting', 'pr', 'influencer', 'b2b', 'b2c', 'market research', 'segmentation', 'positioning'],
                    soft: ['creativity', 'communication', 'strategic thinking', 'data-driven', 'storytelling', 'adaptability', 'collaboration'],
                    achievements: ['increased', 'grew', 'launched', 'generated', 'improved', 'engagement', 'conversion', 'brand awareness']
                }
            },
            sales: {
                labelKey: 'sector_sales',
                keywords: {
                    technical: ['prospecting', 'negotiation', 'crm', 'salesforce', 'hubspot', 'pipeline', 'closing', 'b2b', 'b2c', 'account management', 'cold calling', 'revenue', 'quota', 'forecast', 'territory', 'upselling', 'cross-selling', 'consultative selling', 'solution selling'],
                    soft: ['communication', 'persuasion', 'relationship building', 'resilience', 'goal-oriented', 'empathy', 'negotiation', 'active listening'],
                    achievements: ['exceeded quota', 'closed', 'grew revenue', 'new accounts', 'retained', 'expanded', 'achieved', 'won']
                }
            },
            ops: {
                labelKey: 'sector_ops',
                keywords: {
                    technical: ['project management', 'pmp', 'prince2', 'agile', 'scrum', 'kanban', 'jira', 'operations', 'logistics', 'supply chain', 'process improvement', 'lean', 'six sigma', 'kpi', 'stakeholder', 'budget', 'planning', 'risk management', 'change management', 'bpm', 'erp', 'sap'],
                    soft: ['leadership', 'communication', 'organization', 'problem solving', 'decision making', 'strategic thinking', 'adaptability', 'collaboration'],
                    achievements: ['delivered', 'managed', 'reduced', 'improved', 'optimized', 'streamlined', 'implemented', 'coordinated', 'on-time', 'under budget']
                }
            },
            hr: {
                labelKey: 'sector_hr',
                keywords: {
                    technical: ['recruiting', 'talent acquisition', 'onboarding', 'culture', 'training', 'payroll', 'labor law', 'engagement', 'performance management', 'coaching', 'sourcing', 'linkedin recruiter', 'diversity', 'benefits', 'compensation', 'hris', 'workday', 'successfactors', 'employee relations'],
                    soft: ['empathy', 'communication', 'confidentiality', 'conflict resolution', 'interpersonal skills', 'organizational', 'discretion'],
                    achievements: ['hired', 'reduced turnover', 'improved engagement', 'implemented', 'trained', 'developed programs', 'retention']
                }
            },
            legal: {
                labelKey: 'sector_legal',
                keywords: {
                    technical: ['contract law', 'corporate law', 'litigation', 'compliance', 'regulatory', 'due diligence', 'legal research', 'negotiation', 'intellectual property', 'gdpr', 'data protection', 'employment law', 'mergers', 'acquisitions'],
                    soft: ['analytical', 'attention to detail', 'communication', 'integrity', 'confidentiality', 'problem solving', 'negotiation'],
                    achievements: ['drafted', 'negotiated', 'advised', 'resolved', 'compliance', 'represented', 'won']
                }
            },
            healthcare: {
                labelKey: 'sector_healthcare',
                keywords: {
                    technical: ['clinical', 'patient care', 'diagnosis', 'treatment', 'medical records', 'ehr', 'hipaa', 'healthcare management', 'pharmaceutical', 'clinical trials', 'research', 'nursing', 'surgery', 'radiology', 'laboratory'],
                    soft: ['empathy', 'communication', 'teamwork', 'attention to detail', 'stress management', 'ethical', 'compassionate'],
                    achievements: ['treated', 'improved outcomes', 'implemented', 'research', 'published', 'patient satisfaction', 'quality improvement']
                }
            }
        };

        const levels = [
            { id: 'junior', labelKey: 'level_junior', yearsMin: 0, yearsMax: 3, multiplier: 0.7 },
            { id: 'mid', labelKey: 'level_mid', yearsMin: 3, yearsMax: 7, multiplier: 0.85 },
            { id: 'senior', labelKey: 'level_senior', yearsMin: 7, yearsMax: 15, multiplier: 1.0 },
            { id: 'exec', labelKey: 'level_exec', yearsMin: 15, yearsMax: 50, multiplier: 1.15 }
        ];

        // --- UTILITY FUNCTIONS ---
        function t(key) {
            return translations[state.lang][key] || key;
        }

        function showLoader(textKey) {
            document.getElementById('loaderText').textContent = t(textKey);
            document.getElementById('loader').classList.add('active');
        }

        function hideLoader() {
            document.getElementById('loader').classList.remove('active');
        }

        function normalize(text) {
            return text.toLowerCase()
                .normalize('NFD')
                .replace(/[\u0300-\u036f]/g, '')
                .replace(/[^\w\s]/g, ' ')
                .replace(/\s+/g, ' ')
                .trim();
        }

        function formatDate(lang) {
            return new Date().toLocaleDateString(
                lang === 'en' ? 'en-US' : lang === 'pt' ? 'pt-BR' : 'es-ES',
                { year: 'numeric', month: 'long', day: 'numeric' }
            );
        }

        // --- UI FUNCTIONS ---
        function changeLang(lang) {
            state.lang = lang;
            updateUI();
        }

        function toggleTheme() {
            const isDark = document.body.dataset.theme === 'dark';
            document.body.dataset.theme = isDark ? '' : 'dark';
            document.getElementById('themeIcon').textContent = isDark ? 'üåô' : '‚òÄÔ∏è';
        }

        function toggleAI() {
            const details = document.getElementById('apiDetails');
            const toggle = document.getElementById('aiToggle');
            details.classList.toggle('visible', toggle.checked);
        }

        function goToStep(step) {
            if (step === 3 && !state.profileResults) return;
            
            state.currentStep = step;
            
            document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
            document.getElementById(`panel${step}`).classList.add('active');
            
            document.querySelectorAll('.step').forEach((s, i) => {
                s.classList.remove('active', 'completed');
                if (i + 1 === step) s.classList.add('active');
                if (i + 1 < step) s.classList.add('completed');
            });
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateUI() {
            document.querySelectorAll('[data-i18n]').forEach(el => {
                el.textContent = t(el.dataset.i18n);
            });
            
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                el.placeholder = t(el.dataset.i18nPlaceholder);
            });
            
            renderSectors();
            renderLevels();
            
            // Update results if they exist
            if (state.profileResults) {
                renderResults(!!state.jobFitResults);
            }
        }

        function renderSectors() {
            const grid = document.getElementById('sectorGrid');
            grid.innerHTML = '';
            
            Object.keys(sectors).forEach(key => {
                const pill = document.createElement('div');
                pill.className = 'option-pill' + (state.sector === key ? ' selected' : '');
                pill.textContent = t(sectors[key].labelKey);
                pill.onclick = () => selectSector(key);
                grid.appendChild(pill);
            });
        }

        function renderLevels() {
            const grid = document.getElementById('levelGrid');
            grid.innerHTML = '';
            
            levels.forEach(level => {
                const pill = document.createElement('div');
                pill.className = 'option-pill' + (state.level === level.id ? ' selected' : '');
                pill.textContent = t(level.labelKey);
                pill.onclick = () => selectLevel(level.id);
                grid.appendChild(pill);
            });
        }

        function selectSector(sectorKey) {
            state.sector = sectorKey;
            document.querySelectorAll('#sectorGrid .option-pill').forEach((p, i) => {
                p.classList.toggle('selected', Object.keys(sectors)[i] === sectorKey);
            });
        }

        function selectLevel(levelId) {
            state.level = levelId;
            document.querySelectorAll('#levelGrid .option-pill').forEach((p, i) => {
                p.classList.toggle('selected', levels[i].id === levelId);
            });
        }

        function loadExampleCV() {
            const examples = {
                es: `EXPERIENCIA PROFESIONAL

Senior Project Manager | Tech Solutions Spain | 2018 - Presente
- Lider√© equipos √°giles de 12-15 personas usando metodolog√≠a Scrum y herramientas como JIRA y Confluence.
- Aument√© la eficiencia operativa en un 25% implementando procesos de integraci√≥n continua (CI/CD).
- Gestion√© un presupuesto anual de 600.000‚Ç¨ con desviaci√≥n inferior al 3%.
- Implement√© framework de gesti√≥n de riesgos que redujo incidencias cr√≠ticas en 40%.

Project Manager | Innovation Labs | 2015 - 2018
- Coordin√© 8 proyectos de transformaci√≥n digital con stakeholders internacionales.
- Logr√© 95% de entregas a tiempo mediante implementaci√≥n de metodolog√≠as Lean.
- Facilit√© comunicaci√≥n entre equipos t√©cnicos y direcci√≥n ejecutiva.

Analista de Procesos | Consultora Global | 2012 - 2015
- Desarroll√© an√°lisis de procesos para clientes del sector financiero.
- Particip√© en proyectos de optimizaci√≥n que generaron ahorros de 2M‚Ç¨.

FORMACI√ìN ACAD√âMICA
Executive MBA - IE Business School (2019)
M√°ster en Gesti√≥n de Proyectos - EAE Business School (2015)
Licenciatura en Administraci√≥n de Empresas - Universidad Complutense (2012)

CERTIFICACIONES
- PMP (Project Management Professional)
- Scrum Master Certified
- Lean Six Sigma Green Belt

IDIOMAS
- Espa√±ol: Nativo
- Ingl√©s: C1 Advanced
- Portugu√©s: B2

HABILIDADES T√âCNICAS
Project Management, Agile/Scrum, JIRA, Confluence, MS Project, SAP, Power BI, Excel avanzado, SQL b√°sico, Gesti√≥n presupuestaria, Risk Management, Stakeholder Management`,

                en: `PROFESSIONAL EXPERIENCE

Senior Project Manager | Tech Solutions Europe | 2018 - Present
- Led agile teams of 12-15 people using Scrum methodology and tools like JIRA and Confluence.
- Increased operational efficiency by 25% implementing CI/CD processes.
- Managed annual budget of ‚Ç¨600,000 with deviation under 3%.
- Implemented risk management framework reducing critical incidents by 40%.

Project Manager | Innovation Labs | 2015 - 2018
- Coordinated 8 digital transformation projects with international stakeholders.
- Achieved 95% on-time delivery through Lean methodology implementation.
- Facilitated communication between technical teams and executive management.

Process Analyst | Global Consulting | 2012 - 2015
- Developed process analysis for financial sector clients.
- Participated in optimization projects generating ‚Ç¨2M savings.

EDUCATION
Executive MBA - IE Business School (2019)
Master in Project Management - EAE Business School (2015)
BA Business Administration - Complutense University (2012)

CERTIFICATIONS
- PMP (Project Management Professional)
- Scrum Master Certified
- Lean Six Sigma Green Belt

LANGUAGES
- Spanish: Native
- English: C1 Advanced
- Portuguese: B2

TECHNICAL SKILLS
Project Management, Agile/Scrum, JIRA, Confluence, MS Project, SAP, Power BI, Advanced Excel, Basic SQL, Budget Management, Risk Management, Stakeholder Management`,

                pt: `EXPERI√äNCIA PROFISSIONAL

Senior Project Manager | Tech Solutions Ib√©rica | 2018 - Presente
- Liderei equipes √°geis de 12-15 pessoas usando metodologia Scrum e ferramentas como JIRA e Confluence.
- Aumentei a efici√™ncia operacional em 25% implementando processos de CI/CD.
- Gerenciei or√ßamento anual de ‚Ç¨600.000 com desvio inferior a 3%.
- Implementei framework de gest√£o de riscos que reduziu incidentes cr√≠ticos em 40%.

Project Manager | Innovation Labs | 2015 - 2018
- Coordenei 8 projetos de transforma√ß√£o digital com stakeholders internacionais.
- Alcancei 95% de entregas no prazo atrav√©s da implementa√ß√£o de metodologias Lean.
- Facilitei comunica√ß√£o entre equipes t√©cnicas e dire√ß√£o executiva.

Analista de Processos | Consultoria Global | 2012 - 2015
- Desenvolvi an√°lises de processos para clientes do setor financeiro.
- Participei de projetos de otimiza√ß√£o que geraram economia de ‚Ç¨2M.

FORMA√á√ÉO ACAD√äMICA
Executive MBA - IE Business School (2019)
Mestrado em Gest√£o de Projetos - EAE Business School (2015)
Bacharelado em Administra√ß√£o - Universidade Complutense (2012)

CERTIFICA√á√ïES
- PMP (Project Management Professional)
- Scrum Master Certified
- Lean Six Sigma Green Belt

IDIOMAS
- Portugu√™s: Nativo
- Espanhol: Fluente
- Ingl√™s: C1 Avan√ßado

HABILIDADES T√âCNICAS
Project Management, Agile/Scrum, JIRA, Confluence, MS Project, SAP, Power BI, Excel avan√ßado, SQL b√°sico, Gest√£o or√ßament√°ria, Risk Management, Stakeholder Management`
            };
            
            document.getElementById('cvInput').value = examples[state.lang] || examples.es;
            updateCharCount();
        }

        function updateCharCount() {
            const count = document.getElementById('cvInput').value.length;
            document.getElementById('charCount').textContent = `${count} caracteres`;
        }

        // --- ANALYSIS ENGINE ---
        function analyzeProfile(cvText, sectorKey, levelId) {
            const cv = normalize(cvText);
            const sector = sectors[sectorKey];
            const level = levels.find(l => l.id === levelId);
            
            const yearsMatch = cvText.match(/(\d+)\+?\s*(a√±os|years|anos|year)/i);
            let detectedYears = yearsMatch ? parseInt(yearsMatch[1]) : estimateYearsFromDates(cvText);
            
            const technicalMatches = countMatches(cv, sector.keywords.technical);
            const softMatches = countMatches(cv, sector.keywords.soft);
            const achievementMatches = countMatches(cv, sector.keywords.achievements);
            
            const educationScore = analyzeEducation(cvText);
            const languageScore = analyzeLanguages(cvText);
            
            const metrics = {
                experience: Math.min(100, (detectedYears / level.yearsMax) * 100 * level.multiplier),
                education: educationScore,
                technicalSkills: Math.min(100, (technicalMatches / Math.max(8, sector.keywords.technical.length * 0.4)) * 100),
                softSkills: Math.min(100, (softMatches / Math.max(3, sector.keywords.soft.length * 0.4)) * 100),
                achievements: Math.min(100, (achievementMatches / 5) * 100),
                languages: languageScore
            };
            
            const weights = { experience: 0.25, education: 0.15, technicalSkills: 0.25, softSkills: 0.15, achievements: 0.12, languages: 0.08 };
            const overallScore = Object.keys(metrics).reduce((sum, key) => sum + metrics[key] * weights[key], 0);
            
            const swot = generateSWOT(metrics, technicalMatches, softMatches, sector, level, cvText);
            const recommendations = generateRecommendations(metrics, sector, level, state.lang);
            const synthesis = generateSynthesis(overallScore, metrics, sector, level, state.lang);
            
            return {
                score: Math.round(overallScore),
                metrics,
                swot,
                recommendations,
                synthesis,
                detectedYears,
                technicalKeywords: extractFoundKeywords(cv, sector.keywords.technical),
                softKeywords: extractFoundKeywords(cv, sector.keywords.soft)
            };
        }

        function countMatches(text, keywords) {
            return keywords.filter(kw => text.includes(kw.toLowerCase())).length;
        }

        function extractFoundKeywords(text, keywords) {
            return keywords.filter(kw => text.includes(kw.toLowerCase()));
        }

        function estimateYearsFromDates(cvText) {
            const yearPattern = /\b(19|20)\d{2}\b/g;
            const years = cvText.match(yearPattern);
            if (years && years.length >= 2) {
                const sorted = years.map(Number).sort((a, b) => a - b);
                return Math.min(30, new Date().getFullYear() - sorted[0]);
            }
            return 3;
        }

        function analyzeEducation(cvText) {
            let score = 30;
            const text = cvText.toLowerCase();
            
            if (text.match(/phd|doctorado|doutorado|doctorate/)) score = 100;
            else if (text.match(/mba|master|m√°ster|mestrado|postgrado|postgraduate/)) score = 85;
            else if (text.match(/degree|licenciatura|gradua√ß√£o|bachelor|ingenier|engineer|grado/)) score = 70;
            else if (text.match(/diploma|t√©cnico|technician|fp superior|vocational/)) score = 55;
            
            const certPatterns = ['pmp', 'scrum', 'agile', 'six sigma', 'aws', 'azure', 'google', 'certified', 'certification', 'certificaci√≥n', 'certificado'];
            const certCount = certPatterns.filter(p => text.includes(p)).length;
            score = Math.min(100, score + certCount * 5);
            
            return score;
        }

        function analyzeLanguages(cvText) {
            let score = 40;
            const text = cvText.toLowerCase();
            
            const languagePatterns = [
                /english|ingl√©s|ingl√™s/,
                /french|franc√©s|franc√™s/,
                /german|alem√°n|alem√£o/,
                /spanish|espa√±ol|espanhol/,
                /portuguese|portugu√©s|portugu√™s/,
                /italian|italiano/,
                /chinese|chino|chin√™s/,
                /japanese|japon√©s|japon√™s/
            ];
            
            const foundLangs = languagePatterns.filter(p => p.test(text)).length;
            
            if (text.match(/c2|native|nativo|fluent|fluente|bilingual|biling√ºe/)) score += 20;
            if (text.match(/c1|advanced|avanzado|avan√ßado/)) score += 15;
            if (text.match(/b2|intermediate|intermedio|intermedi√°rio/)) score += 10;
            
            score += foundLangs * 10;
            
            return Math.min(100, score);
        }

        function generateSWOT(metrics, techCount, softCount, sector, level, cvText) {
            const swot = {
                strengths: [],
                weaknesses: [],
                opportunities: [],
                threats: []
            };
            
            const lang = state.lang;
            
            // STRENGTHS
            if (metrics.experience >= 70) {
                swot.strengths.push(lang === 'es' ? 'S√≥lida trayectoria profesional con experiencia demostrable' : 
                                     lang === 'en' ? 'Strong professional track record with demonstrable experience' :
                                     'S√≥lida trajet√≥ria profissional com experi√™ncia demonstr√°vel');
            }
            if (metrics.technicalSkills >= 60) {
                swot.strengths.push(lang === 'es' ? 'Competencias t√©cnicas alineadas con el sector' :
                                     lang === 'en' ? 'Technical skills aligned with the sector' :
                                     'Compet√™ncias t√©cnicas alinhadas com o setor');
            }
            if (metrics.education >= 75) {
                swot.strengths.push(lang === 'es' ? 'Formaci√≥n acad√©mica y certificaciones relevantes' :
                                     lang === 'en' ? 'Relevant academic background and certifications' :
                                     'Forma√ß√£o acad√™mica e certifica√ß√µes relevantes');
            }
            if (metrics.achievements >= 60) {
                swot.strengths.push(lang === 'es' ? 'Logros cuantificables que demuestran impacto' :
                                     lang === 'en' ? 'Quantifiable achievements demonstrating impact' :
                                     'Conquistas quantific√°veis que demonstram impacto');
            }
            if (metrics.languages >= 70) {
                swot.strengths.push(lang === 'es' ? 'Perfil multiling√ºe con ventaja competitiva internacional' :
                                     lang === 'en' ? 'Multilingual profile with international competitive advantage' :
                                     'Perfil multil√≠ngue com vantagem competitiva internacional');
            }
            if (metrics.softSkills >= 60) {
                swot.strengths.push(lang === 'es' ? 'Habilidades blandas bien desarrolladas' :
                                     lang === 'en' ? 'Well-developed soft skills' :
                                     'Soft skills bem desenvolvidas');
            }
            
            if (swot.strengths.length < 2) {
                swot.strengths.push(lang === 'es' ? 'CV estructurado y claro' :
                                     lang === 'en' ? 'Structured and clear CV' :
                                     'CV estruturado e claro');
            }
            
            // WEAKNESSES
            if (metrics.technicalSkills < 50) {
                swot.weaknesses.push(lang === 'es' ? 'Limitadas menciones de habilidades t√©cnicas espec√≠ficas del sector' :
                                      lang === 'en' ? 'Limited mentions of sector-specific technical skills' :
                                      'Poucas men√ß√µes de habilidades t√©cnicas espec√≠ficas do setor');
            }
            if (metrics.achievements < 50) {
                swot.weaknesses.push(lang === 'es' ? 'Falta de logros cuantificables con m√©tricas claras' :
                                      lang === 'en' ? 'Lack of quantifiable achievements with clear metrics' :
                                      'Falta de conquistas quantific√°veis com m√©tricas claras');
            }
            if (metrics.languages < 50) {
                swot.weaknesses.push(lang === 'es' ? 'Perfil de idiomas limitado para mercado internacional' :
                                      lang === 'en' ? 'Limited language profile for international market' :
                                      'Perfil de idiomas limitado para mercado internacional');
            }
            if (metrics.softSkills < 50) {
                swot.weaknesses.push(lang === 'es' ? 'Soft skills poco destacadas en el perfil' :
                                      lang === 'en' ? 'Soft skills not highlighted in profile' :
                                      'Soft skills pouco destacadas no perfil');
            }
            if (metrics.education < 50) {
                swot.weaknesses.push(lang === 'es' ? 'Formaci√≥n acad√©mica podr√≠a ser reforzada' :
                                      lang === 'en' ? 'Academic background could be strengthened' :
                                      'Forma√ß√£o acad√™mica poderia ser refor√ßada');
            }
            
            if (swot.weaknesses.length === 0) {
                swot.weaknesses.push(lang === 'es' ? 'Considerar incluir m√°s proyectos recientes' :
                                      lang === 'en' ? 'Consider including more recent projects' :
                                      'Considerar incluir mais projetos recentes');
            }
            
            // OPPORTUNITIES
            swot.opportunities.push(lang === 'es' ? 'Alta demanda de profesionales en ' + t(sector.labelKey) :
                                     lang === 'en' ? 'High demand for professionals in ' + t(sector.labelKey) :
                                     'Alta demanda de profissionais em ' + t(sector.labelKey));
            
            if (metrics.technicalSkills >= 50) {
                swot.opportunities.push(lang === 'es' ? 'Posibilidad de certificaciones adicionales para diferenciaci√≥n' :
                                         lang === 'en' ? 'Opportunity for additional certifications for differentiation' :
                                         'Possibilidade de certifica√ß√µes adicionais para diferencia√ß√£o');
            }
            
            swot.opportunities.push(lang === 'es' ? 'Mercado laboral favorable para perfiles con experiencia' :
                                     lang === 'en' ? 'Favorable job market for experienced profiles' :
                                     'Mercado de trabalho favor√°vel para perfis com experi√™ncia');
            
            swot.opportunities.push(lang === 'es' ? 'Tendencia hacia trabajo remoto ampl√≠a opciones' :
                                     lang === 'en' ? 'Remote work trend expands options' :
                                     'Tend√™ncia de trabalho remoto amplia op√ß√µes');
            
            // THREATS
            swot.threats.push(lang === 'es' ? 'Alta competencia en el sector ' + t(sector.labelKey) :
                              lang === 'en' ? 'High competition in ' + t(sector.labelKey) + ' sector' :
                              'Alta competi√ß√£o no setor de ' + t(sector.labelKey));
            
            swot.threats.push(lang === 'es' ? 'Evoluci√≥n tecnol√≥gica requiere actualizaci√≥n constante' :
                              lang === 'en' ? 'Technological evolution requires constant updating' :
                              'Evolu√ß√£o tecnol√≥gica requer atualiza√ß√£o constante');
            
            if (level.id === 'senior' || level.id === 'exec') {
                swot.threats.push(lang === 'es' ? 'Expectativas salariales pueden limitar opciones' :
                                  lang === 'en' ? 'Salary expectations may limit options' :
                                  'Expectativas salariais podem limitar op√ß√µes');
            }
            
            return swot;
        }

        function generateRecommendations(metrics, sector, level, lang) {
            const recs = [];
            const sortedMetrics = Object.entries(metrics).sort((a, b) => a[1] - b[1]);
            
            sortedMetrics.slice(0, 3).forEach(([key, value], index) => {
                const priority = index === 0 ? 'high' : index === 1 ? 'medium' : 'low';
                
                const recMap = {
                    experience: {
                        es: { title: 'Destacar experiencia relevante', desc: 'Enfatiza proyectos espec√≠ficos con resultados medibles y responsabilidades claras.' },
                        en: { title: 'Highlight relevant experience', desc: 'Emphasize specific projects with measurable results and clear responsibilities.' },
                        pt: { title: 'Destacar experi√™ncia relevante', desc: 'Enfatize projetos espec√≠ficos com resultados mensur√°veis e responsabilidades claras.' }
                    },
                    education: {
                        es: { title: 'Reforzar formaci√≥n', desc: 'Considera certificaciones del sector como ' + getRelevantCerts(sector) + '.' },
                        en: { title: 'Strengthen education', desc: 'Consider sector certifications like ' + getRelevantCerts(sector) + '.' },
                        pt: { title: 'Refor√ßar forma√ß√£o', desc: 'Considere certifica√ß√µes do setor como ' + getRelevantCerts(sector) + '.' }
                    },
                    technicalSkills: {
                        es: { title: 'Ampliar habilidades t√©cnicas', desc: 'Incluye m√°s palabras clave del sector: ' + sector.keywords.technical.slice(0, 5).join(', ') + '.' },
                        en: { title: 'Expand technical skills', desc: 'Include more sector keywords: ' + sector.keywords.technical.slice(0, 5).join(', ') + '.' },
                        pt: { title: 'Ampliar habilidades t√©cnicas', desc: 'Inclua mais palavras-chave do setor: ' + sector.keywords.technical.slice(0, 5).join(', ') + '.' }
                    },
                    softSkills: {
                        es: { title: 'Destacar soft skills', desc: 'A√±ade ejemplos concretos de liderazgo, comunicaci√≥n y trabajo en equipo.' },
                        en: { title: 'Highlight soft skills', desc: 'Add concrete examples of leadership, communication and teamwork.' },
                        pt: { title: 'Destacar soft skills', desc: 'Adicione exemplos concretos de lideran√ßa, comunica√ß√£o e trabalho em equipe.' }
                    },
                    achievements: {
                        es: { title: 'Cuantificar logros', desc: 'Transforma descripciones en logros con m√©tricas: %, ‚Ç¨, tiempo ahorrado, etc.' },
                        en: { title: 'Quantify achievements', desc: 'Transform descriptions into achievements with metrics: %, ‚Ç¨, time saved, etc.' },
                        pt: { title: 'Quantificar conquistas', desc: 'Transforme descri√ß√µes em conquistas com m√©tricas: %, ‚Ç¨, tempo economizado, etc.' }
                    },
                    languages: {
                        es: { title: 'Potenciar idiomas', desc: 'Considera certificaciones oficiales (Cambridge, DELE, DELF) para validar niveles.' },
                        en: { title: 'Strengthen languages', desc: 'Consider official certifications (Cambridge, DELE, DELF) to validate levels.' },
                        pt: { title: 'Potenciar idiomas', desc: 'Considere certifica√ß√µes oficiais (Cambridge, DELE, DELF) para validar n√≠veis.' }
                    }
                };
                
                if (recMap[key] && recMap[key][lang]) {
                    recs.push({
                        priority,
                        title: recMap[key][lang].title,
                        desc: recMap[key][lang].desc
                    });
                }
            });
            
            const generalRecs = {
                es: { title: 'Optimizar para ATS', desc: 'Usa formato limpio, evita tablas complejas y asegura que las palabras clave sean detectables.' },
                en: { title: 'Optimize for ATS', desc: 'Use clean format, avoid complex tables and ensure keywords are detectable.' },
                pt: { title: 'Otimizar para ATS', desc: 'Use formato limpo, evite tabelas complexas e garanta que as palavras-chave sejam detect√°veis.' }
            };
            
            recs.push({
                priority: 'low',
                title: generalRecs[lang].title,
                desc: generalRecs[lang].desc
            });
            
            return recs;
        }

        function getRelevantCerts(sector) {
            const certs = {
                tech: 'AWS, Azure, Google Cloud, Scrum Master',
                finance: 'CFA, FRM, ACCA, certificaciones AML/KYC',
                marketing: 'Google Analytics, HubSpot, Meta Blueprint',
                sales: 'Salesforce, HubSpot Sales, Miller Heiman',
                ops: 'PMP, PRINCE2, Six Sigma, Scrum',
                hr: 'SHRM, CIPD, coaching certificado',
                legal: 'especializaciones en compliance, GDPR',
                healthcare: 'especializaciones cl√≠nicas relevantes'
            };
            return certs[state.sector] || 'certificaciones del sector';
        }

        function generateSynthesis(score, metrics, sector, level, lang) {
            const sectorName = t(sector.labelKey);
            const levelName = t(levels.find(l => l.id === level.id).labelKey);
            
            let quality = '';
            if (score >= 80) quality = lang === 'es' ? 'excelente' : lang === 'en' ? 'excellent' : 'excelente';
            else if (score >= 65) quality = lang === 'es' ? 's√≥lido' : lang === 'en' ? 'solid' : 's√≥lido';
            else if (score >= 50) quality = lang === 'es' ? 'competitivo' : lang === 'en' ? 'competitive' : 'competitivo';
            else quality = lang === 'es' ? 'en desarrollo' : lang === 'en' ? 'developing' : 'em desenvolvimento';
            
            const sortedMetrics = Object.entries(metrics).sort((a, b) => b[1] - a[1]);
            const strongest = sortedMetrics[0][0];
            const weakest = sortedMetrics[sortedMetrics.length - 1][0];
            
            const metricNames = {
                experience: { es: 'experiencia', en: 'experience', pt: 'experi√™ncia' },
                education: { es: 'formaci√≥n', en: 'education', pt: 'forma√ß√£o' },
                technicalSkills: { es: 'habilidades t√©cnicas', en: 'technical skills', pt: 'habilidades t√©cnicas' },
                softSkills: { es: 'habilidades blandas', en: 'soft skills', pt: 'soft skills' },
                achievements: { es: 'logros', en: 'achievements', pt: 'conquistas' },
                languages: { es: 'idiomas', en: 'languages', pt: 'idiomas' }
            };
            
            const templates = {
                es: `Perfil profesional ${quality} para el sector de ${sectorName} en nivel ${levelName}. Tu punto m√°s fuerte es ${metricNames[strongest].es} (${Math.round(metrics[strongest])}%), mientras que ${metricNames[weakest].es} (${Math.round(metrics[weakest])}%) representa el √°rea con mayor potencial de mejora. La puntuaci√≥n global de ${score}% indica un perfil ${score >= 65 ? 'bien posicionado para oportunidades en el mercado actual' : 'con oportunidades claras de optimizaci√≥n para aumentar la competitividad'}.`,
                
                en: `${quality.charAt(0).toUpperCase() + quality.slice(1)} professional profile for ${sectorName} sector at ${levelName} level. Your strongest point is ${metricNames[strongest].en} (${Math.round(metrics[strongest])}%), while ${metricNames[weakest].en} (${Math.round(metrics[weakest])}%) represents the area with greatest improvement potential. The overall score of ${score}% indicates a profile ${score >= 65 ? 'well-positioned for opportunities in the current market' : 'with clear optimization opportunities to increase competitiveness'}.`,
                
                pt: `Perfil profissional ${quality} para o setor de ${sectorName} em n√≠vel ${levelName}. Seu ponto mais forte √© ${metricNames[strongest].pt} (${Math.round(metrics[strongest])}%), enquanto ${metricNames[weakest].pt} (${Math.round(metrics[weakest])}%) representa a √°rea com maior potencial de melhoria. A pontua√ß√£o global de ${score}% indica um perfil ${score >= 65 ? 'bem posicionado para oportunidades no mercado atual' : 'com oportunidades claras de otimiza√ß√£o para aumentar a competitividade'}.`
            };
            
            return templates[lang];
        }

        // --- JOB FIT ANALYSIS ---
        function analyzeJobFit(cvText, jobText, profileResults) {
            const cvNorm = normalize(cvText);
            const jobNorm = normalize(jobText);
            
            const jobKeywords = extractJobKeywords(jobText);
            
            const matching = [];
            const gaps = [];
            
            jobKeywords.forEach(kw => {
                if (cvNorm.includes(kw.toLowerCase())) {
                    matching.push(kw);
                } else {
                    gaps.push(kw);
                }
            });
            
            const matchRatio = jobKeywords.length > 0 ? matching.length / jobKeywords.length : 0;
            const fitScore = Math.round(matchRatio * 60 + (profileResults.score / 100) * 40);
            
            const fitRecommendations = generateFitRecommendations(matching, gaps, state.lang);
            
            return {
                score: fitScore,
                matching,
                gaps,
                recommendations: fitRecommendations
            };
        }

        function extractJobKeywords(jobText) {
            const text = normalize(jobText);
            const allKeywords = [];
            
            if (state.sector && sectors[state.sector]) {
                allKeywords.push(...sectors[state.sector].keywords.technical);
                allKeywords.push(...sectors[state.sector].keywords.soft);
            }
            
            const commonPatterns = [
                'excel', 'powerpoint', 'word', 'outlook',
                'team', 'leadership', 'communication', 'analytical',
                'problem solving', 'proactive', 'autonomous', 'flexible',
                'english', 'spanish', 'portuguese', 'french', 'german',
                'bachelor', 'master', 'mba', 'degree',
                'experience', 'years', 'senior', 'junior', 'manager'
            ];
            
            const foundKeywords = [...new Set([...allKeywords, ...commonPatterns])].filter(kw => 
                text.includes(kw.toLowerCase())
            );
            
            return foundKeywords.slice(0, 30);
        }

        function generateFitRecommendations(matching, gaps, lang) {
            const templates = {
                es: {
                    highlight: `Para esta posici√≥n, aseg√∫rate de destacar especialmente: ${matching.slice(0, 5).join(', ') || 'tus competencias principales'}.`,
                    gaps: gaps.length > 0 ? `Considera adquirir o destacar competencias en: ${gaps.slice(0, 5).join(', ')}.` : 'Tu perfil cubre los requisitos principales de la posici√≥n.',
                    general: 'Personaliza tu carta de presentaci√≥n mencionando logros espec√≠ficos relacionados con los requisitos del puesto.'
                },
                en: {
                    highlight: `For this position, make sure to especially highlight: ${matching.slice(0, 5).join(', ') || 'your main competencies'}.`,
                    gaps: gaps.length > 0 ? `Consider acquiring or highlighting skills in: ${gaps.slice(0, 5).join(', ')}.` : 'Your profile covers the main requirements of the position.',
                    general: 'Customize your cover letter mentioning specific achievements related to the job requirements.'
                },
                pt: {
                    highlight: `Para esta posi√ß√£o, certifique-se de destacar especialmente: ${matching.slice(0, 5).join(', ') || 'suas compet√™ncias principais'}.`,
                    gaps: gaps.length > 0 ? `Considere adquirir ou destacar compet√™ncias em: ${gaps.slice(0, 5).join(', ')}.` : 'Seu perfil cobre os requisitos principais da posi√ß√£o.',
                    general: 'Personalize sua carta de apresenta√ß√£o mencionando conquistas espec√≠ficas relacionadas aos requisitos da vaga.'
                }
            };
            
            return `${templates[lang].highlight} ${templates[lang].gaps} ${templates[lang].general}`;
        }

        // --- MAIN ANALYSIS FUNCTIONS ---
        async function runProfileAnalysis() {
            if (!state.sector) {
                alert(t('error_sector'));
                return;
            }
            if (!state.level) {
                alert(t('error_level'));
                return;
            }
            
            const cvText = document.getElementById('cvInput').value.trim();
            if (cvText.length < 100) {
                alert(t('error_cv'));
                return;
            }
            
            state.cv = cvText;
            state.apiKey = document.getElementById('apiKeyInput').value.trim();
            
            showLoader('loading_profile');
            
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            state.profileResults = analyzeProfile(state.cv, state.sector, state.level);
            
            hideLoader();
            goToStep(2);
        }

        async function runJobFitAnalysis() {
            const jobText = document.getElementById('jobInput').value.trim();
            if (jobText.length < 50) {
                alert(t('error_job'));
                return;
            }
            
            state.job = jobText;
            
            showLoader('loading_jobfit');
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            state.jobFitResults = analyzeJobFit(state.cv, state.job, state.profileResults);
            
            hideLoader();
            renderResults(true);
            goToStep(3);
        }

        function skipJobFit() {
            state.jobFitResults = null;
            renderResults(false);
            goToStep(3);
        }

        // --- RENDERING ---
        function renderResults(includeJobFit) {
            const results = state.profileResults;
            const score = includeJobFit && state.jobFitResults ? state.jobFitResults.score : results.score;
            
            // Update date
            document.getElementById('resultsDate').textContent = formatDate(state.lang);
            
            // Update score display
            document.getElementById('mainScore').textContent = score + '%';
            document.getElementById('scoreLabel').textContent = includeJobFit && state.jobFitResults ? t('score_jobfit') : t('score_profile');
            
            // Score interpretation
            let interpretation = '';
            if (score >= 80) interpretation = t('interpretation_excellent');
            else if (score >= 65) interpretation = t('interpretation_good');
            else if (score >= 50) interpretation = t('interpretation_average');
            else interpretation = t('interpretation_developing');
            document.getElementById('scoreInterpretation').textContent = interpretation;
            
            // Update metadata
            document.getElementById('metaSector').textContent = t(sectors[state.sector].labelKey);
            document.getElementById('metaLevel').textContent = t(levels.find(l => l.id === state.level).labelKey);
            document.getElementById('metaYears').textContent = `~${results.detectedYears} ${t('years')}`;
            
            // Render gauge
            renderScoreGauge(score);
            
            // Render radar chart
            renderRadarChart(results.metrics);
            
            // Render metrics bars
            renderMetrics(results.metrics);
            
            // Render synthesis
            document.getElementById('synthesisText').textContent = results.synthesis;
            
            // Render SWOT
            renderSWOT(results.swot);
            
            // Render recommendations
            renderRecommendations(results.recommendations);
            
            // Render job fit results if available
            const jobFitSection = document.getElementById('jobFitResults');
            if (includeJobFit && state.jobFitResults) {
                jobFitSection.classList.remove('hidden');
                renderJobFit(state.jobFitResults);
            } else {
                jobFitSection.classList.add('hidden');
            }
        }

        function renderScoreGauge(score) {
            const canvas = document.getElementById('scoreGauge');
            const ctx = canvas.getContext('2d');
            
            ctx.clearRect(0, 0, 200, 200);
            
            const centerX = 100;
            const centerY = 100;
            const radius = 85;
            const lineWidth = 14;
            
            // Background arc
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, 0.75 * Math.PI, 2.25 * Math.PI);
            ctx.strokeStyle = '#e2e8f0';
            ctx.lineWidth = lineWidth;
            ctx.lineCap = 'round';
            ctx.stroke();
            
            // Score arc
            const scoreAngle = 0.75 * Math.PI + (score / 100) * 1.5 * Math.PI;
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, 0.75 * Math.PI, scoreAngle);
            
            // Gradient
            const gradient = ctx.createLinearGradient(0, 0, 200, 200);
            gradient.addColorStop(0, '#d4a853');
            gradient.addColorStop(1, '#a37633');
            ctx.strokeStyle = gradient;
            ctx.lineWidth = lineWidth;
            ctx.lineCap = 'round';
            ctx.stroke();
        }

        function renderRadarChart(metrics) {
            const ctx = document.getElementById('radarChart').getContext('2d');
            
            if (state.charts.radar) {
                state.charts.radar.destroy();
            }
            
            const labels = [
                t('metric_experience'),
                t('metric_education'),
                t('metric_skills'),
                t('metric_soft'),
                t('metric_achievements'),
                t('metric_languages')
            ];
            
            const data = [
                metrics.experience,
                metrics.education,
                metrics.technicalSkills,
                metrics.softSkills,
                metrics.achievements,
                metrics.languages
            ];
            
            state.charts.radar = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: 'rgba(212, 168, 83, 0.2)',
                        borderColor: '#d4a853',
                        borderWidth: 2,
                        pointBackgroundColor: '#d4a853',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#d4a853'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                stepSize: 25,
                                font: {
                                    size: 10
                                }
                            },
                            pointLabels: {
                                font: {
                                    size: 11,
                                    family: "'DM Sans', sans-serif"
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        }
                    }
                }
            });
        }

        function renderMetrics(metrics) {
            const container = document.getElementById('metricsContainer');
            container.innerHTML = '';
            
            const metricConfig = [
                { key: 'experience', label: t('metric_experience'), color: '#d4a853' },
                { key: 'education', label: t('metric_education'), color: '#a37633' },
                { key: 'technicalSkills', label: t('metric_skills'), color: '#059669' },
                { key: 'softSkills', label: t('metric_soft'), color: '#0284c7' },
                { key: 'achievements', label: t('metric_achievements'), color: '#7c3aed' },
                { key: 'languages', label: t('metric_languages'), color: '#db2777' }
            ];
            
            metricConfig.forEach(({ key, label, color }) => {
                const value = Math.round(metrics[key]);
                const html = `
                    <div class="metric-item">
                        <span class="metric-label">${label}</span>
                        <div class="metric-bar">
                            <div class="metric-fill" style="width: ${value}%; background: ${color};"></div>
                        </div>
                        <span class="metric-value">${value}%</span>
                    </div>
                `;
                container.innerHTML += html;
            });
        }

        function renderSWOT(swot) {
            const renderList = (items, containerId) => {
                const container = document.getElementById(containerId);
                container.innerHTML = items.map(item => `<li>${item}</li>`).join('');
            };
            
            renderList(swot.strengths, 'strengthsList');
            renderList(swot.weaknesses, 'weaknessesList');
            renderList(swot.opportunities, 'opportunitiesList');
            renderList(swot.threats, 'threatsList');
        }

        function renderRecommendations(recommendations) {
            const container = document.getElementById('recommendationsList');
            container.innerHTML = recommendations.map((rec, index) => `
                <li class="rec-item">
                    <div class="rec-priority ${rec.priority}">${index + 1}</div>
                    <div class="rec-content">
                        <div class="rec-title">${rec.title}</div>
                        <div class="rec-desc">${rec.desc}</div>
                    </div>
                </li>
            `).join('');
        }

        function renderJobFit(fitResults) {
            const matchingContainer = document.getElementById('matchingSkills');
            matchingContainer.innerHTML = fitResults.matching.map(skill => 
                `<span class="tag match">${skill}</span>`
            ).join('');
            
            const gapContainer = document.getElementById('gapSkills');
            gapContainer.innerHTML = fitResults.gaps.slice(0, 10).map(skill => 
                `<span class="tag missing">${skill}</span>`
            ).join('');
            
            document.getElementById('fitRecommendationsText').textContent = fitResults.recommendations;
        }

        // --- PDF GENERATION (Using html2canvas for exact visual replica) ---
        async function generatePDF() {
            showLoader('loading_pdf');
            
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'mm', 'a4');
            const pageWidth = 210;
            const pageHeight = 297;
            const margin = 10;
            const contentWidth = pageWidth - (margin * 2);
            
            // Force light theme for PDF
            const originalTheme = document.body.dataset.theme;
            document.body.dataset.theme = '';
            
            // Wait for theme to apply
            await new Promise(resolve => setTimeout(resolve, 100));
            
            const resultsContent = document.getElementById('resultsContent');
            
            // Get all sections to capture
            const sections = [
                document.getElementById('resultsHeader'),
                document.getElementById('competenciesCard'),
                document.getElementById('synthesisCard'),
                document.getElementById('swotCard'),
                document.getElementById('recommendationsCard')
            ];
            
            // Add job fit if visible
            const jobFitCard = document.getElementById('jobFitResults');
            if (!jobFitCard.classList.contains('hidden')) {
                sections.push(jobFitCard);
            }
            
            // Add footer
            sections.push(document.getElementById('resultsFooter'));
            
            let currentY = margin;
            let pageNum = 1;
            
            for (let i = 0; i < sections.length; i++) {
                const section = sections[i];
                if (!section) continue;
                
                try {
                    const canvas = await html2canvas(section, {
                        scale: 2,
                        useCORS: true,
                        allowTaint: true,
                        backgroundColor: '#fefdfb',
                        logging: false
                    });
                    
                    const imgData = canvas.toDataURL('image/png');
                    const imgWidth = contentWidth;
                    const imgHeight = (canvas.height * imgWidth) / canvas.width;
                    
                    // Check if we need a new page
                    if (currentY + imgHeight > pageHeight - margin && i > 0) {
                        // Add page number to current page
                        pdf.setFontSize(8);
                        pdf.setTextColor(150);
                        pdf.text(`${pageNum}`, pageWidth / 2, pageHeight - 5, { align: 'center' });
                        
                        pdf.addPage();
                        pageNum++;
                        currentY = margin;
                    }
                    
                    // Add image to PDF
                    pdf.addImage(imgData, 'PNG', margin, currentY, imgWidth, imgHeight);
                    currentY += imgHeight + 5;
                    
                } catch (error) {
                    console.error('Error capturing section:', error);
                }
            }
            
            // Add page number to last page
            pdf.setFontSize(8);
            pdf.setTextColor(150);
            pdf.text(`${pageNum}`, pageWidth / 2, pageHeight - 5, { align: 'center' });
            
            // Restore original theme
            document.body.dataset.theme = originalTheme;
            
            // Save PDF
            const filename = `RV_Profile_Analysis_${new Date().toISOString().split('T')[0]}.pdf`;
            pdf.save(filename);
            
            hideLoader();
        }

        // --- CONTACT ---
        function contactConsultant() {
            const subject = encodeURIComponent('Solicitud de Asesoramiento - RV Profile Studio');
            const body = encodeURIComponent(`Hola,\n\nHe realizado un an√°lisis de mi perfil profesional con RV Profile Studio y me gustar√≠a solicitar una sesi√≥n de asesoramiento.\n\nMi puntuaci√≥n fue: ${state.profileResults?.score || 'N/A'}%\nSector: ${state.sector ? t(sectors[state.sector].labelKey) : 'N/A'}\n\nQuedo a la espera de su respuesta.\n\nSaludos.`);
            window.open(`mailto:${CONFIG.consultantEmail}?subject=${subject}&body=${body}`);
        }

        function resetApp() {
            state = {
                lang: state.lang,
                sector: null,
                level: null,
                cv: '',
                job: '',
                apiKey: '',
                profileResults: null,
                jobFitResults: null,
                currentStep: 1,
                charts: {}
            };
            
            document.getElementById('cvInput').value = '';
            document.getElementById('jobInput').value = '';
            document.getElementById('apiKeyInput').value = '';
            document.getElementById('aiToggle').checked = false;
            document.getElementById('apiDetails').classList.remove('visible');
            document.getElementById('charCount').textContent = '0 caracteres';
            
            document.querySelectorAll('.option-pill').forEach(p => p.classList.remove('selected'));
            
            document.querySelectorAll('.step').forEach((s, i) => {
                s.classList.remove('active', 'completed');
                if (i === 0) s.classList.add('active');
            });
            
            goToStep(1);
        }

        // --- INITIALIZATION ---
        function init() {
            renderSectors();
            renderLevels();
            
            document.getElementById('cvInput').addEventListener('input', updateCharCount);
            
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.body.dataset.theme = 'dark';
                document.getElementById('themeIcon').textContent = '‚òÄÔ∏è';
            }
            
            console.log('RV Profile Studio v' + CONFIG.version + ' initialized');
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
